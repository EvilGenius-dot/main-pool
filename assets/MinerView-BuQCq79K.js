import{_ as Y,n as Z,h as ee,f as o,p as te,K as j,v as ae,c as _,b as a,l as m,w as R,O as se,L as k,t as r,d as A,u,a as ne,x as le,B as oe,F as ie,C as re,G as $,H as M,I as L,z as I,j as de,aV as ce,k as ue,o as f,m as ve}from"./index-BWeRxd06.js";import{E as _e}from"./el-pagination-CIOjKplf.js";const fe={class:"over-container"},Ce={class:"p-4"},xe={class:"pt-4 px-4"},Ie={class:"border-t border-b py-2 text-zinc-300 border-zinc-700 bg-zinc-800 border-b-0 rounded-tl-2xl rounded-tr-2xl"},he={class:"flex justify-around items-center"},pe={class:"text-zinc-200 text-xs"},Te={class:"text-zinc-200 text-xs"},be={class:"text-zinc-200 text-xs"},ge={class:"mb-10 border-t border-b border-zinc-700 bg-zinc-800 rounded-bl-2xl rounded-br-2xl"},me={key:0,class:"relative"},Ae={class:"flex py-2 text-xs text-zinc-300 border-b border-zinc-700"},Ue={class:"w-20 flex"},we={class:"w-20 flex"},Ne={class:"miner-box"},Ee={key:0,class:"miner-item flex justify-center items-center text-xs py-4 text-zinc-400"},Se=["onClick"],Ve={class:"w-5 flex justify-center"},Oe={key:0,class:"online"},ke={key:1,class:"offline"},ze={class:"w-28 flex"},Be={class:"w-20 flex"},ye={class:"w-20 flex"},De={class:"w-20 flex"},He={class:"demo-pagination-block"},je={__name:"MinerView",setup(Re){const P=de();ce();const d=Z(),s=ee(),C=o("all"),T=o(""),U=o(!1),z=o(!1),B=o(!1),w=o(0),N=o(0),E=o(0),S=o(1),b=o(100),F=o("default"),W=o(!1),K=o(!1),V=o(0),v=te({online:0,offline:0,currentHash:0,hash24:0}),y=o([]),G=t=>{let e=t.workerId||"unknow",l=t.workerName||"unknow";P.push({name:"minerinfo",params:{workerName:l,workerId:e,avgHashrate1440:t.avgHashrate1440,avgRejectrate1440:t.avgRejectrate1440,lastShareTime:t.lastShareTime,realtimeHashrate:t.realtimeHashrate,status:t.status,sid:s.ACTIVE_SUB_ACCOUNT_ID}})},g=t=>{B.value=!0,z.value=!0,$({url:M.get_account_info.replace("{coin}",d.ACTIVE_COIN).replace("{sid}",t)}).then(e=>{if(B.value=!1,z.value=!1,e.data.status==0){let l=I(d.ACTIVE_COIN,e.data.data.hashrate),x=I(d.ACTIVE_COIN,e.data.data.avg_hashrate1440);v.currentHash=`${l.num} ${l.unit}`,v.hash24=`${x.num} ${x.unit}`,v.online=e.data.data.online,v.offline=e.data.data.offline}else L.error("获取账户信息失败。")})},q=t=>{console.log(`${t} items per page`)},J=t=>{p(s.ACTIVE_SUB_ACCOUNT_ID)},h=o([]),D=()=>{for(let t in v)v[t]=0;h.value=[]},p=t=>{t&&(U.value=!0,$({method:"get",url:M.get_workers.replace("{coin}",d.ACTIVE_COIN).replace("{sid}",t)}).then(e=>{e.data.status==0?(y.value=e.data.data,H(e.data.data)):L.error("获取矿工信息失败！"),U.value=!1}))},Q=t=>{H(y.value)},H=t=>{h.value=[],V.value=0,w.value=0,N.value=0,E.value=0;let e=[];V.value=t.length,w.value=t.length;for(let i=0;i<t.length;i++){let c=t[i];c.status!="active"?E.value+=1:N.value+=1,!(T.value&&c.workerName.indexOf(T.value)==-1)&&(C.value=="all"&&e.push(c),C.value=="online"&&c.status=="active"&&e.push(c),C.value=="offline"&&c.status!="active"&&e.push(c))}let l=(S.value-1)*b.value,x=l+b.value;e=e.slice(l,x),e.forEach(i=>{h.value.push({workerName:i.workerName,realtimeHashrate:i.realtimeHashrate,avgHashrate1440:i.avgHashrate1440,avgRejectrate1440:i.avgRejectrate1440,lastShareTime:i.lastShareTime,status:i.status,workerId:i.workerId})})},O=t=>{C.value=t,p(s.ACTIVE_SUB_ACCOUNT_ID),g(s.ACTIVE_SUB_ACCOUNT_ID)};return j(()=>s.SUB_ACCOUNT,(t,e)=>{D();const l=s.SUB_ACCOUNT;s.ACTIVE_SUB_ACCOUNT_ID==null&&l[0]&&s.SET_ACTIVE_SUB_ACCOUNT_ID(l[0].id),l[0]&&(p(s.ACTIVE_SUB_ACCOUNT_ID),g(s.ACTIVE_SUB_ACCOUNT_ID))},{deep:!0}),j(()=>d.ACTIVE_COIN,(t,e)=>{D();const l=s.SUB_ACCOUNT;s.ACTIVE_SUB_ACCOUNT_ID==null&&l[0]&&s.SET_ACTIVE_SUB_ACCOUNT_ID(l[0].id),l[0]&&(p(s.ACTIVE_SUB_ACCOUNT_ID),g(s.ACTIVE_SUB_ACCOUNT_ID))},{deep:!0}),ae(()=>{const t=s.SUB_ACCOUNT;s.ACTIVE_SUB_ACCOUNT_ID==null&&t[0]&&s.SET_ACTIVE_SUB_ACCOUNT_ID(t[0].id),t[0]&&(p(s.ACTIVE_SUB_ACCOUNT_ID),g(s.ACTIVE_SUB_ACCOUNT_ID))}),(t,e)=>{const l=ue("search"),x=ve,i=se,c=_e,X=oe;return f(),_("div",fe,[a("div",Ce,[m(i,{class:"miner-view-search",modelValue:T.value,"onUpdate:modelValue":e[0]||(e[0]=n=>T.value=n),onInput:Q,size:"large",placeholder:"输入矿工名搜索"},{suffix:R(()=>[m(x,{class:"el-input__icon"},{default:R(()=>[m(l)]),_:1})]),_:1},8,["modelValue"])]),a("div",xe,[a("div",Ie,[a("div",he,[a("div",{onClick:e[1]||(e[1]=n=>O("all")),class:k(["mode-item border-r border-zinc-600 flex items-center justify-center flex-col w-1/3",{active:C.value=="all"}])},[e[6]||(e[6]=a("div",{class:"text-zinc-300 text-sm mb-1"}," 全部 ",-1)),a("div",pe,r(w.value),1)],2),a("div",{onClick:e[2]||(e[2]=n=>O("online")),class:k(["mode-item border-r border-zinc-600 flex items-center justify-center flex-col w-1/3",{active:C.value=="online"}])},[e[7]||(e[7]=a("div",{class:"text-zinc-300 text-sm mb-1"}," 在线 ",-1)),a("div",Te,r(N.value),1)],2),a("div",{onClick:e[3]||(e[3]=n=>O("offline")),class:k(["mode-item flex items-center justify-center w-1/3 flex-col",{active:C.value=="offline"}])},[e[8]||(e[8]=a("div",{class:"text-zinc-300 text-sm mb-1"}," 离线 ",-1)),a("div",be,r(E.value),1)],2)])]),a("div",ge,[u(s).ACTIVE_SUB_ACCOUNT_ID!==null?(f(),_("div",me,[e[12]||(e[12]=ne('<div class="flex py-2 text-xs text-zinc-300 border-zinc-700" data-v-f4bf421b><div class="w-5 flex justify-center" data-v-f4bf421b></div><div class="w-28 flex" data-v-f4bf421b> 矿工名 </div><div class="w-20 flex" data-v-f4bf421b> 10分钟算力 </div><div class="w-20 flex" data-v-f4bf421b> 24小时算力 </div><div class="w-20 flex" data-v-f4bf421b> 拒绝率 </div></div>',1)),a("div",Ae,[e[9]||(e[9]=a("div",{class:"w-5 flex justify-center"},null,-1)),e[10]||(e[10]=a("div",{class:"w-28 flex"}," 总计 ",-1)),a("div",Ue,r(v.currentHash),1),a("div",we,r(v.hash24),1),e[11]||(e[11]=a("div",{class:"w-20 flex"}," - ",-1))]),a("div",Ne,[le((f(),_("div",null,[h.value.length?A("",!0):(f(),_("div",Ee," 无活跃矿工 ")),(f(!0),_(ie,null,re(h.value,n=>(f(),_("div",{class:"miner-item flex justify-between items-center text-xs py-4 text-zinc-400",onClick:$e=>G(n)},[a("div",Ve,[n.status=="active"?(f(),_("div",Oe)):A("",!0),n.status=="inactive"?(f(),_("div",ke)):A("",!0)]),a("div",ze,r(n.workerName),1),a("div",Be,r(u(I)(u(d).ACTIVE_COIN,n.realtimeHashrate).num)+" "+r(u(I)(u(d).ACTIVE_COIN,n.realtimeHashrate).unit),1),a("div",ye,r(u(I)(u(d).ACTIVE_COIN,n.avgHashrate1440).num)+" "+r(u(I)(u(d).ACTIVE_COIN,n.avgHashrate1440).unit),1),a("div",De,r((n.avgRejectrate1440*100).toFixed(2))+" % ",1)],8,Se))),256))])),[[X,U.value]])]),a("div",He,[m(c,{"current-page":S.value,"onUpdate:currentPage":e[4]||(e[4]=n=>S.value=n),"page-size":b.value,"onUpdate:pageSize":e[5]||(e[5]=n=>b.value=n),size:F.value,disabled:W.value,background:K.value,layout:"prev, pager, next",total:V.value,onSizeChange:q,onCurrentChange:J},null,8,["current-page","page-size","size","disabled","background","total"])])])):A("",!0)])])])}}},Pe=Y(je,[["__scopeId","data-v-f4bf421b"]]);export{Pe as default};
