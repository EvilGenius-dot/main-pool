import{K as L,n as Y,h as G,q as M,f,p,s as q,L as U,v as Q,c as P,b as t,x as E,A as T,u as c,l as D,D as J,y as N,t as s,B as K,w as W,G as b,H as A,z as B,I as O,J as j,j as X,o as R}from"./index-LtxatZno.js";import{E as Z}from"./index-Cze8zZ0N.js";const tt={class:"over-container"},et={class:"w-full h-40 relative z-0"},st={class:"pointer-events-none absolute inset-0 w-full h-full p-4"},at={class:"text-5xl font-bold transition-all"},it={class:"text-lime-500"},nt={class:"overflow-hidden z-0 bg-zinc-900 relative w-full h-full"},ot={class:"p-4 -translate-y-12"},lt={class:"p-4 grid gap-3 grid-cols-2 rounded-lg w-full border border-zinc-700 bg-zinc-800"},rt={class:"text-sm text-zinc-200"},ct={class:"text-zinc-400 text-xs mb-2"},dt={class:"flex justify-center font-bold"},_t={class:"text-lime-500"},ft={class:"text-sm text-zinc-200"},ut={class:"text-zinc-400 text-xs mb-2"},ht={class:"flex justify-center items-center font-bold"},vt={class:"mr-2"},Ct={class:"text-lime-500"},xt={class:"text-zinc-400"},mt={class:"text-sm text-zinc-200"},It={class:"text-zinc-400 text-xs mb-2"},pt={class:"flex justify-center font-bold"},Et={class:"text-sm text-zinc-200"},Tt={class:"text-zinc-400 text-xs mb-2"},Nt={class:"flex justify-center font-bold"},bt={class:"py-4"},At={class:"flex mb-2 items-center justify-between text-xs text-zinc-400"},Ot={class:"flex mb-2 items-center justify-between text-xs text-zinc-400"},gt={class:"flex mb-2 items-center justify-between text-xs text-zinc-400"},yt={class:"flex mb-2 items-center justify-between text-xs text-zinc-400"},Vt={class:"flex mb-2 items-center justify-between text-xs text-zinc-400"},$t={class:"flex mb-2 items-center justify-between text-xs text-zinc-400"},zt={class:"flex mb-2 items-center justify-between text-xs text-zinc-400"},wt={class:"flex mb-2 items-center justify-between text-xs text-zinc-400"},Dt={__name:"DashBoard",setup(St){const{t:u}=L(),n=Y(),d=G(),g=M();X();const y=f(!1),V=f(!1),$=f(!1),C=f(!1);f(!1);const z=f("hourly"),w=f(null),F=p({color:"rgba(161, 161, 170, 1)"}),x=p({series:[{name:u("全部子账号"),data:[],xAxisData:[]}],showLegend:!1,coin:""}),a=p({online:0,offline:0,totalProfit:0,unpaidProfit:0,yesterdayProfit:0,currentHash:0,hash24:0,estimateProfit:0}),S=()=>{for(let e in a)a[e]=0},H=q(()=>{let e=u("计算中..."),i=g.QUOTES[n.ACTIVE_COIN],r=g.RATES.CNY,l=a.totalProfit;return i&&r&&l?e="¥ "+(Number(l)*i*r).toFixed(4):e="¥ 0.0000",e}),v=e=>Number(e).toFixed(8),k=e=>{j.locale("zh-cn");let i=e.start_time||e.startTime,r=e.hashrates,l={data:[],time:[]};for(let _=0;_<r.length;_++){let h;z.value=="hourly"?h=i+6e5*_:h=i+864e5*_,l.data.push(r[_]),l.time.push(j(h).format("MMMM Do YYYY, h:mm:ss a"))}return l},m=e=>{V.value=!0,y.value=!0,$.value=!0,b({url:A.get_account_info.replace("{coin}",n.ACTIVE_COIN).replace("{sid}",e)}).then(i=>{if(V.value=!1,y.value=!1,i.data.status==0){let r=B(n.ACTIVE_COIN,i.data.data.hashrate),l=B(n.ACTIVE_COIN,i.data.data.avg_hashrate1440);a.currentHash=`${r.num} ${r.unit}`,a.hash24=`${l.num} ${l.unit}`,a.online=i.data.data.online,a.offline=i.data.data.offline}else O.error(u("获取账户信息失败。"))}),b({url:A.get_account_profit.replace("{coin}",n.ACTIVE_COIN).replace("{sid}",e)}).then(i=>{if($.value=!1,i.data.status==0){let r=0,l=0,_=0,h=0;i.data.data.forEach(o=>{o.profit!=null&&o.status=="all"&&(r=o.profit?o.profit:0),o.profit!=null&&o.status=="yesterday"&&(l=o.profit?o.profit:0),o.profit!=null&&o.status=="unpaid"&&(_=o.profit?o.profit:0),o.profit!=null&&o.status=="estimate_profit"&&(h=o.profit?o.profit:0)}),a.unpaidProfit=_,a.yesterdayProfit=l,a.totalProfit=r,a.estimateProfit=h}else O.error(u("获取收益失败。"))})},I=()=>{d.ACTIVE_SUB_ACCOUNT_ID===null&&d.OBSERVER||n.GET_FEE_COIN()||(C.value=!0,b({method:"get",url:A.get_account_hash.replace("{sid}",d.ACTIVE_SUB_ACCOUNT_ID).replace("{coin}",n.ACTIVE_COIN).replace("{mode}",z.value)}).then(e=>{if(C.value=!1,e.data.status==0){let i=k(e.data.data);x.series=[{name:`${n.ACTIVE_COIN}${u("算力")}`,data:i.data,xAxisData:i.time}],x.coin=n.ACTIVE_COIN,w.value.initChart()}else O.error(u("获取图表失败。"))}))};return U(()=>d.ACTIVE_SUB_ACCOUNT_ID,(e,i)=>{S(),e!==null&&(m(d.ACTIVE_SUB_ACCOUNT_ID),I())}),U(()=>n.ACTIVE_COIN,(e,i)=>{S(),e!==null&&(m(d.ACTIVE_SUB_ACCOUNT_ID),I())}),Q(()=>{d.ACTIVE_SUB_ACCOUNT_ID!==null&&(m(d.ACTIVE_SUB_ACCOUNT_ID),I())}),(e,i)=>{const r=Z,l=K;return R(),P("div",tt,[t("div",et,[E(D(J,{chartConfig:x,ref_key:"hashChartRef",ref:w},null,8,["chartConfig"]),[[T,!c(n).GET_FEE_COIN()]]),E(t("div",st,[t("h2",at,[t("span",it,s(a.currentHash),1),i[0]||(i[0]=N(" / S "))])],512),[[T,!c(n).GET_FEE_COIN()]]),E((R(),P("div",nt,[D(r,{content:`${e.$t("挖")}${c(n).GET_FEE_COIN_BY_COIN()}${e.$t("赠")}${c(n).ACTIVE_COIN}`,font:F},{default:W(()=>i[1]||(i[1]=[t("div",{style:{height:"400px"}},null,-1)])),_:1},8,["content","font"])])),[[T,c(n).GET_FEE_COIN()],[l,C.value]])]),t("div",ot,[t("div",lt,[t("div",rt,[t("div",ct,s(e.$t("24小时平均算力")),1),t("div",dt,[t("span",_t,s(a.hash24||0),1)])]),t("div",ft,[t("div",ut,s(e.$t("矿机")),1),t("div",ht,[t("div",vt,[N(s(e.$t("在线"))+" ",1),t("span",Ct,s(a.online||0),1)]),t("div",null,[N(s(e.$t("离线"))+" ",1),t("span",xt,s(a.offline||0),1)])])]),t("div",mt,[t("div",It,s(e.$t("总收益")),1),t("div",pt,s(v(a.totalProfit))+" "+s(c(n).ACTIVE_COIN),1)]),t("div",Et,[t("div",Tt,s(e.$t("今日已挖（预估）")),1),t("div",Nt,s(v(a.estimateProfit))+" "+s(c(n).ACTIVE_COIN),1)])]),t("div",bt,[t("div",At,[t("div",null,s(e.$t("24H算力")),1),t("div",null,s(a.hash24||0),1)]),t("div",Ot,[t("div",null,s(e.$t("10分钟算力")),1),t("div",null,s(a.currentHash||0),1)]),t("div",gt,[t("div",null,s(e.$t("活跃设备")),1),t("div",null,s(a.online||0),1)]),t("div",yt,[t("div",null,s(e.$t("离线设备")),1),t("div",null,s(a.offline||0),1)]),t("div",Vt,[t("div",null,s(e.$t("总收益")),1),t("div",null,s(v(a.totalProfit))+" "+s(c(n).ACTIVE_COIN),1)]),t("div",$t,[t("div",null,s(e.$t("总收益预估CNY")),1),t("div",null,s(H.value),1)]),t("div",zt,[t("div",null,s(e.$t("未支付收益")),1),t("div",null,s(v(Number(a.unpaidProfit)+Number(a.estimateProfit)))+" "+s(c(n).ACTIVE_COIN),1)]),t("div",wt,[t("div",null,s(e.$t("今日已挖")),1),t("div",null,s(v(a.estimateProfit))+" "+s(c(n).ACTIVE_COIN),1)])])])])}}};export{Dt as default};
