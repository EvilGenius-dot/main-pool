import{_ as me,n as he,h as pe,f as _,p as ge,i as W,K as Y,v as Ie,k as S,c as p,o as f,b as l,d as I,u as i,F as Te,C as xe,L as B,l as s,y as u,w as o,m as Ae,t as d,N as Ue,x as T,A as E,M as Ee,O as we,B as Ne,g as Se,z as w,J as Oe,G,H as K,I as J}from"./index-BWeRxd06.js";import{E as be}from"./el-pagination-CIOjKplf.js";import{E as Ve,a as ke}from"./el-table-column-BYdxIFg2.js";import{E as Be}from"./el-progress-DcCzR3Pc.js";import{_ as De}from"./online-BeAw_8w7.js";import{_ as q}from"./CPU-Cl-hhvhq.js";const ze={class:"w-full h-full"},He={class:"h-full py-4 max-w-[90rem] mx-auto px-6 bg-zinc-950"},ye={key:0,class:"flex gap-6"},Me={class:"flex flex-col gap-6 flex-grow"},Fe={class:"user-list w-full flex gap-3 text-slate-300 text-sm flex-wrap"},Re=["onClick"],$e={key:1,class:"text-slate-300 text-sm flex justify-center items-center"},je={key:2,class:"text-slate-300 text-sm px-4 py-3"},Le={class:"grid gap-6 grid-cols-3 max-[800px]:grid-cols-1 mt-5"},Pe={class:"flex"},We={class:"flex-1 overflow-hidden min-w-0 break-words"},Ye={class:"text-zinc-50 text-lg font-bold"},Ge={class:"pl-5"},Ke={class:"text-lime-500"},Je={class:"text-zinc-50"},qe={class:"flex"},Qe={class:"flex-1 overflow-hidden min-w-0 break-words"},Xe={class:"text-zinc-50 text-lg font-bold"},Ze={class:"flex"},et={class:"flex-1 overflow-hidden min-w-0 break-words"},tt={class:"text-zinc-50 text-lg font-bold"},at={key:3,class:"mt-5 flex justify-between items-center"},st={key:4},lt={key:0,class:"online"},nt={key:1,class:"offline"},ot={class:"demo-pagination-block mt-5"},it={__name:"MinerView",setup(rt){const C=he(),a=pe(),g=_("all"),O=_(""),D=_(!1),b=_(!1),x=_(!1),z=_(0),H=_(0),y=_(0),M=_(1),V=_(100),Q=_("default"),X=_(!1),Z=_(!1),F=_(0),m=ge({online:0,offline:0,currentHash:0,hash24:0}),j=_([]),ee=W("minerHashChart-show"),N=t=>{C.GET_FEE_COIN(C.ACTIVE_COIN)||(x.value=!0,b.value=!0,G({url:K.get_account_info.replace("{coin}",C.ACTIVE_COIN).replace("{sid}",t)}).then(e=>{if(x.value=!1,b.value=!1,e.data.status==0){let c=w(C.ACTIVE_COIN,e.data.data.hashrate),h=w(C.ACTIVE_COIN,e.data.data.avg_hashrate1440);m.currentHash=`${c.num} ${c.unit}`,m.hash24=`${h.num} ${h.unit}`,m.online=e.data.data.online,m.offline=e.data.data.offline}else J.error("获取账户信息失败。")}))},te=t=>{console.log(`${t} items per page`)},ae=t=>{A(a.ACTIVE_SUB_ACCOUNT_ID)},se=W("createSubAccount-show"),k=_([]),L=()=>{for(let t in m)m[t]=0;k.value=[]},le=t=>{a.SET_ACTIVE_SUB_ACCOUNT_ID(t),A(t),N(a.ACTIVE_SUB_ACCOUNT_ID)},A=t=>{!t||C.GET_FEE_COIN(C.ACTIVE_COIN)||(D.value=!0,G({method:"get",url:K.get_workers.replace("{coin}",C.ACTIVE_COIN).replace("{sid}",t)}).then(e=>{e.data.status==0?(j.value=e.data.data,P(e.data.data)):J.error("获取矿工信息失败！"),D.value=!1}))},ne=t=>{P(j.value)},P=t=>{k.value=[],F.value=0,z.value=0,H.value=0,y.value=0;let e=[];F.value=t.length,z.value=t.length;for(let r=0;r<t.length;r++){let v=t[r];v.status!="active"?y.value+=1:H.value+=1,!(O.value&&v.workerName.indexOf(O.value)==-1)&&(g.value=="all"&&e.push(v),g.value=="online"&&v.status=="active"&&e.push(v),g.value=="offline"&&v.status!="active"&&e.push(v))}let c=(M.value-1)*V.value,h=c+V.value;e=e.slice(c,h),e.forEach(r=>{k.value.push({workerName:r.workerName,realtimeHashrate:r.realtimeHashrate,avgHashrate1440:r.avgHashrate1440,avgRejectrate1440:r.avgRejectrate1440,lastShareTime:r.lastShareTime,status:r.status,workerId:r.workerId})})},oe=t=>{ee(t)},R=t=>{g.value=t,A(a.ACTIVE_SUB_ACCOUNT_ID),N(a.ACTIVE_SUB_ACCOUNT_ID)};return Y(()=>a.SUB_ACCOUNT,(t,e)=>{L();const c=a.SUB_ACCOUNT;a.ACTIVE_SUB_ACCOUNT_ID==null&&c[0]&&a.SET_ACTIVE_SUB_ACCOUNT_ID(c[0].id),c[0]&&(A(a.ACTIVE_SUB_ACCOUNT_ID),N(a.ACTIVE_SUB_ACCOUNT_ID))},{deep:!0}),Y(()=>C.ACTIVE_COIN,(t,e)=>{L();const c=a.SUB_ACCOUNT;a.ACTIVE_SUB_ACCOUNT_ID==null&&c[0]&&a.SET_ACTIVE_SUB_ACCOUNT_ID(c[0].id),c[0]&&(A(a.ACTIVE_SUB_ACCOUNT_ID),N(a.ACTIVE_SUB_ACCOUNT_ID))},{deep:!0}),Ie(()=>{const t=a.SUB_ACCOUNT;a.ACTIVE_SUB_ACCOUNT_ID==null&&t[0]&&a.SET_ACTIVE_SUB_ACCOUNT_ID(t[0].id),t[0]&&(A(a.ACTIVE_SUB_ACCOUNT_ID),N(a.ACTIVE_SUB_ACCOUNT_ID))}),(t,e)=>{const c=S("UserFilled"),h=Ae,r=Ue,v=Be,$=Ee,ie=S("Histogram"),re=S("Finished"),_e=S("WarnTriangleFilled"),ce=S("search"),ue=we,U=Ve,de=ke,Ce=be,ve=Ne;return f(),p("div",ze,[l("div",He,[i(a).SUB_ACCOUNT.length?(f(),p("div",ye,[l("div",Me,[l("div",Fe,[(f(!0),p(Te,null,xe(i(a).SUB_ACCOUNT,(n,fe)=>(f(),p("div",{key:fe,class:B(["flex items-center py-2 px-4 rounded-md hover:cursor-pointer hover:bg-zinc-800 active:bg-zinc-500 transition-all",{active:i(a).ACTIVE_SUB_ACCOUNT_ID===n.id}]),onClick:_t=>le(n.id)},[s(h,{class:"mr-1"},{default:o(()=>[s(c)]),_:1}),u(" "+d(n.name),1)],10,Re))),128))])])])):I("",!0),i(a).SUB_ACCOUNT.length?I("",!0):(f(),p("div",$e,[e[7]||(e[7]=u(" 尚未创建子账号, 请先")),s(r,{class:"menu-item active ml-1",onClick:i(se)},{default:o(()=>e[6]||(e[6]=[u("创建")])),_:1},8,["onClick"])])),i(a).ACTIVE_SUB_ACCOUNT_ID===null?(f(),p("div",je," 请在上方选择一个子账号开始查询矿工。 ")):I("",!0),l("div",Le,[s($,null,{default:o(()=>[l("div",Pe,[l("div",We,[e[9]||(e[9]=l("div",{class:"flex items-center text-zinc-300 text-xs mb-2"},[l("img",{src:De,class:"h-4 mr-1"}),u(" 活跃 / 离线 ")],-1)),T(s(v,{class:"h-7",percentage:50,indeterminate:!0,"show-text":!1},null,512),[[E,b.value]]),l("div",Ye,[T(l("div",Ge,[l("span",Ke,d(m.online),1),e[8]||(e[8]=u(" / ")),l("span",Je,d(m.offline),1)],512),[[E,!b.value]])])])])]),_:1}),s($,null,{default:o(()=>[l("div",qe,[l("div",Qe,[e[10]||(e[10]=l("div",{class:"flex items-center text-zinc-300 text-xs mb-2"},[l("img",{src:q,class:"h-4 mr-1"}),u(" 当前算力 ")],-1)),T(s(v,{class:"h-7",percentage:50,indeterminate:!0,"show-text":!1},null,512),[[E,x.value]]),l("div",Xe,[T(l("div",{class:"pl-5"},d(m.currentHash),513),[[E,!x.value]])])])])]),_:1}),s($,null,{default:o(()=>[l("div",Ze,[l("div",et,[e[11]||(e[11]=l("div",{class:"flex items-center text-zinc-300 text-xs mb-2"},[l("img",{src:q,class:"h-4 mr-1"}),u(" 24H算力 ")],-1)),T(s(v,{class:"h-7",percentage:50,indeterminate:!0,"show-text":!1},null,512),[[E,x.value]]),l("div",tt,[T(l("div",{class:"pl-5"},d(m.hash24),513),[[E,!x.value]])])])])]),_:1})]),i(a).ACTIVE_SUB_ACCOUNT_ID!==null?(f(),p("div",at,[l("div",null,[s(r,{class:B(["menu-item ml-1",{active:g.value=="all"}]),onClick:e[0]||(e[0]=n=>R("all"))},{default:o(()=>[s(h,{class:"mr-1"},{default:o(()=>[s(ie)]),_:1}),u(" 全部（"+d(z.value)+"） ",1)]),_:1},8,["class"]),s(r,{class:B(["menu-item ml-5",{active:g.value=="online"}]),onClick:e[1]||(e[1]=n=>R("online"))},{default:o(()=>[s(h,{class:"mr-1"},{default:o(()=>[s(re)]),_:1}),u(" 在线（"+d(H.value)+"） ",1)]),_:1},8,["class"]),s(r,{class:B(["menu-item ml-5",{active:g.value=="offline"}]),onClick:e[2]||(e[2]=n=>R("offline"))},{default:o(()=>[s(h,{class:"mr-1"},{default:o(()=>[s(_e)]),_:1}),u(" 离线（"+d(y.value)+"） ",1)]),_:1},8,["class"])]),l("div",null,[s(ue,{modelValue:O.value,"onUpdate:modelValue":e[3]||(e[3]=n=>O.value=n),style:{width:"240px"},placeholder:"搜索矿工",onInput:ne},{prefix:o(()=>[s(h,{class:"el-input__icon"},{default:o(()=>[s(ce)]),_:1})]),_:1},8,["modelValue"])])])):I("",!0),i(a).ACTIVE_SUB_ACCOUNT_ID!==null?(f(),p("div",st,[T((f(),Se(de,{data:k.value,class:"w-full mt-5 shadow-[0_0_0_1px_rgba(107,114,128,.3)] rounded-md",stripe:"","row-class-name":"table-row-class","empty-text":"无矿工",onRowClick:oe},{default:o(()=>[s(U,{prop:"status",label:" ",width:"20"},{default:o(n=>[n.row.status=="active"?(f(),p("div",lt)):I("",!0),n.row.status=="inactive"||n.row.status=="unactive"?(f(),p("div",nt)):I("",!0)]),_:1}),s(U,{prop:"workerName",label:"矿工",sortable:""}),s(U,{prop:"realtimeHashrate",label:"10分钟算力",sortable:""},{default:o(n=>[u(d(i(w)(i(C).ACTIVE_COIN,n.row.realtimeHashrate).num)+" "+d(i(w)(i(C).ACTIVE_COIN,n.row.realtimeHashrate).unit),1)]),_:1}),s(U,{prop:"avgHashrate1440",label:"24小时算力",sortable:""},{default:o(n=>[u(d(i(w)(i(C).ACTIVE_COIN,n.row.avgHashrate1440).num)+" "+d(i(w)(i(C).ACTIVE_COIN,n.row.avgHashrate1440).unit),1)]),_:1}),s(U,{prop:"avgRejectrate1440",label:"拒绝率",sortable:""},{default:o(n=>[u(d((n.row.avgRejectrate1440*100).toFixed(2))+" % ",1)]),_:1}),s(U,{prop:"lastShareTime",label:"最近提交日期"},{default:o(n=>[u(d(i(Oe)(n.row.lastShareTime*1e3).format("MMMM Do YYYY, h:mm:ss a")),1)]),_:1})]),_:1},8,["data"])),[[ve,D.value]]),l("div",ot,[s(Ce,{"current-page":M.value,"onUpdate:currentPage":e[4]||(e[4]=n=>M.value=n),"page-size":V.value,"onUpdate:pageSize":e[5]||(e[5]=n=>V.value=n),size:Q.value,disabled:X.value,background:Z.value,layout:"prev, pager, next",total:F.value,onSizeChange:te,onCurrentChange:ae},null,8,["current-page","page-size","size","disabled","background","total"])])])):I("",!0)])])}}},mt=me(it,[["__scopeId","data-v-5ddba484"]]);export{mt as default};
