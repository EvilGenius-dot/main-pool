import{_ as fe,J as me,k as ve,g as he,e as f,l as pe,I as Ie,i as j,K as L,m as Te,n as b,c as p,o as m,a as l,b as T,u as _,F as ge,z as Ae,L as D,j as s,s as C,w as i,q as Ue,t as o,N as Ee,p as g,x as w,M as we,O as xe,y as Ne,f as Se,v as x,G as be,B as P,C as W,D as Y}from"./index-DC_M4ZfZ.js";import{E as Oe}from"./el-pagination-CGK-kzKm.js";import{E as Ve,a as ke}from"./el-table-column-BaYyDBsr.js";import{E as Be}from"./el-progress-QmW1hCtp.js";import{_ as De}from"./online-BeAw_8w7.js";import{_ as G}from"./CPU-Cl-hhvhq.js";const $e={class:"w-full h-full"},ze={class:"h-full py-4 max-w-[90rem] mx-auto px-6"},ye={key:0,class:"flex gap-6"},He={class:"flex flex-col gap-6 flex-grow"},Fe={class:"user-list w-full flex gap-3 text-slate-300 text-sm flex-wrap"},Me=["onClick"],Re={key:1,class:"text-slate-300 text-sm flex justify-center items-center"},je={key:2,class:"text-slate-300 text-sm px-4 py-3"},Le={class:"grid gap-6 grid-cols-3 max-[800px]:grid-cols-1 mt-5"},Pe={class:"flex"},We={class:"flex-1 overflow-hidden min-w-0 break-words"},Ye={class:"flex items-center text-zinc-300 text-xs mb-2"},Ge={class:"text-zinc-50 text-lg font-bold"},Ke={class:"pl-5"},qe={class:"text-lime-500"},Je={class:"text-zinc-50"},Qe={class:"flex"},Xe={class:"flex-1 overflow-hidden min-w-0 break-words"},Ze={class:"flex items-center text-zinc-300 text-xs mb-2"},et={class:"text-zinc-50 text-lg font-bold"},tt={class:"flex"},at={class:"flex-1 overflow-hidden min-w-0 break-words"},st={class:"flex items-center text-zinc-300 text-xs mb-2"},lt={class:"text-zinc-50 text-lg font-bold"},nt={key:3,class:"mt-5 flex justify-between items-center"},ot={key:4},it={key:0,class:"online"},rt={key:1,class:"offline"},_t={class:"demo-pagination-block mt-5"},ct={__name:"MinerView",setup(ut){const{t:F}=me(),d=ve(),a=he(),I=f("all"),O=f(""),$=f(!1),V=f(!1),A=f(!1),k=f(1),N=f(200),K=f("default"),q=f(!1),J=f(!1),r=pe({online:0,offline:0,currentHash:0,hash24:0}),Q=Ie(()=>r.online||r.offline?(r.online||0)+(r.offline||0):z.value.length),z=f([]),X=j("minerHashChart-show"),S=e=>{d.GET_FEE_COIN(d.ACTIVE_COIN)||(A.value=!0,V.value=!0,P({url:W.get_account_info.replace("{coin}",d.ACTIVE_COIN).replace("{sid}",e)}).then(t=>{if(A.value=!1,V.value=!1,t.data.status==0){let u=x(d.ACTIVE_COIN,t.data.data.hashrate),v=x(d.ACTIVE_COIN,t.data.data.avg_hashrate1440);r.currentHash=`${u.num} ${u.unit}`,r.hash24=`${v.num} ${v.unit}`,r.online=t.data.data.online,r.offline=t.data.data.offline}else Y.error(F("获取账户信息失败。"))}))},Z=e=>{console.log(`${e} items per page`)},ee=e=>{U(a.ACTIVE_SUB_ACCOUNT_ID)},te=j("createSubAccount-show"),B=f([]),M=()=>{for(let e in r)r[e]=0;B.value=[]},ae=e=>{a.SET_ACTIVE_SUB_ACCOUNT_ID(e),U(e),S(a.ACTIVE_SUB_ACCOUNT_ID)},U=e=>{!e||d.GET_FEE_COIN(d.ACTIVE_COIN)||($.value=!0,P({method:"get",url:W.get_workers.replace("{coin}",d.ACTIVE_COIN).replace("{sid}",e).replace("{page}",k.value).replace("{size}",N.value)}).then(t=>{t.data.status==0?(z.value=t.data.data,R(t.data.data)):Y.error(F("获取矿工信息失败！")),$.value=!1}))},se=e=>{R(z.value)},R=e=>{B.value=[];let t=[];for(let c=0;c<e.length;c++){let h=e[c];O.value&&h.workerName.indexOf(O.value)==-1||(I.value=="all"&&t.push(h),I.value=="online"&&h.status=="active"&&t.push(h),I.value=="offline"&&h.status!="active"&&t.push(h))}let u=(k.value-1)*N.value,v=u+N.value;d.ACTIVE_COIN=="VA-LTC"&&(t=t.slice(u,v)),t.forEach(c=>{B.value.push({workerName:c.workerName,realtimeHashrate:c.realtimeHashrate,avgHashrate1440:c.avgHashrate1440,avgRejectrate1440:c.avgRejectrate1440,lastShareTime:c.lastShareTime,status:c.status,workerId:c.workerId})})},le=e=>{X(e)},y=e=>{I.value=e,U(a.ACTIVE_SUB_ACCOUNT_ID),S(a.ACTIVE_SUB_ACCOUNT_ID)};return L(()=>a.SUB_ACCOUNT,(e,t)=>{M();const u=a.SUB_ACCOUNT;a.ACTIVE_SUB_ACCOUNT_ID==null&&u[0]&&a.SET_ACTIVE_SUB_ACCOUNT_ID(u[0].id),u[0]&&(U(a.ACTIVE_SUB_ACCOUNT_ID),S(a.ACTIVE_SUB_ACCOUNT_ID))},{deep:!0}),L(()=>d.ACTIVE_COIN,(e,t)=>{M();const u=a.SUB_ACCOUNT;a.ACTIVE_SUB_ACCOUNT_ID==null&&u[0]&&a.SET_ACTIVE_SUB_ACCOUNT_ID(u[0].id),u[0]&&(U(a.ACTIVE_SUB_ACCOUNT_ID),S(a.ACTIVE_SUB_ACCOUNT_ID))},{deep:!0}),Te(()=>{const e=a.SUB_ACCOUNT;a.ACTIVE_SUB_ACCOUNT_ID==null&&e[0]&&a.SET_ACTIVE_SUB_ACCOUNT_ID(e[0].id),e[0]&&(U(a.ACTIVE_SUB_ACCOUNT_ID),S(a.ACTIVE_SUB_ACCOUNT_ID))}),(e,t)=>{const u=b("UserFilled"),v=Ue,c=Ee,h=Be,H=we,ne=b("Histogram"),oe=b("Finished"),ie=b("WarnTriangleFilled"),re=b("search"),_e=xe,E=Ve,ce=ke,ue=Oe,de=Ne;return m(),p("div",$e,[l("div",ze,[_(a).SUB_ACCOUNT.length?(m(),p("div",ye,[l("div",He,[l("div",Fe,[(m(!0),p(ge,null,Ae(_(a).SUB_ACCOUNT,(n,Ce)=>(m(),p("div",{key:Ce,class:D(["flex items-center py-2 px-4 rounded-md hover:cursor-pointer hover:bg-zinc-800 active:bg-zinc-500 transition-all",{active:_(a).ACTIVE_SUB_ACCOUNT_ID===n.id}]),onClick:dt=>ae(n.id)},[s(v,{class:"mr-1"},{default:i(()=>[s(u)]),_:1}),C(" "+o(n.name),1)],10,Me))),128))])])])):T("",!0),_(a).SUB_ACCOUNT.length?T("",!0):(m(),p("div",Re,[C(o(e.$t("尚未创建子账号, 请先")),1),s(c,{class:"menu-item active ml-1",onClick:_(te)},{default:i(()=>[C(o(e.$t("创建")),1)]),_:1},8,["onClick"])])),_(a).ACTIVE_SUB_ACCOUNT_ID===null?(m(),p("div",je,o(e.$t("请在上方选择一个子账号开始查询矿工。")),1)):T("",!0),l("div",Le,[s(H,null,{default:i(()=>[l("div",Pe,[l("div",We,[l("div",Ye,[t[6]||(t[6]=l("img",{src:De,class:"h-4 mr-1"},null,-1)),C(" "+o(e.$t("活跃 / 离线")),1)]),g(s(h,{class:"h-7",percentage:50,indeterminate:!0,"show-text":!1},null,512),[[w,V.value]]),l("div",Ge,[g(l("div",Ke,[l("span",qe,o(r.online),1),t[7]||(t[7]=C(" / ")),l("span",Je,o(r.offline),1)],512),[[w,!V.value]])])])])]),_:1}),s(H,null,{default:i(()=>[l("div",Qe,[l("div",Xe,[l("div",Ze,[t[8]||(t[8]=l("img",{src:G,class:"h-4 mr-1"},null,-1)),C(" "+o(e.$t("当前算力")),1)]),g(s(h,{class:"h-7",percentage:50,indeterminate:!0,"show-text":!1},null,512),[[w,A.value]]),l("div",et,[g(l("div",{class:"pl-5"},o(r.currentHash),513),[[w,!A.value]])])])])]),_:1}),s(H,null,{default:i(()=>[l("div",tt,[l("div",at,[l("div",st,[t[9]||(t[9]=l("img",{src:G,class:"h-4 mr-1"},null,-1)),C(" "+o(e.$t("24H算力")),1)]),g(s(h,{class:"h-7",percentage:50,indeterminate:!0,"show-text":!1},null,512),[[w,A.value]]),l("div",lt,[g(l("div",{class:"pl-5"},o(r.hash24),513),[[w,!A.value]])])])])]),_:1})]),_(a).ACTIVE_SUB_ACCOUNT_ID!==null?(m(),p("div",nt,[l("div",null,[s(c,{class:D(["menu-item ml-1",{active:I.value=="all"}]),onClick:t[0]||(t[0]=n=>y("all"))},{default:i(()=>[s(v,{class:"mr-1"},{default:i(()=>[s(ne)]),_:1}),C(" "+o(e.$t("全部"))+"（"+o(r.online+r.offline)+"） ",1)]),_:1},8,["class"]),s(c,{class:D(["menu-item ml-5",{active:I.value=="online"}]),onClick:t[1]||(t[1]=n=>y("online"))},{default:i(()=>[s(v,{class:"mr-1"},{default:i(()=>[s(oe)]),_:1}),C(" "+o(e.$t("在线"))+"（"+o(r.online)+"） ",1)]),_:1},8,["class"]),s(c,{class:D(["menu-item ml-5",{active:I.value=="offline"}]),onClick:t[2]||(t[2]=n=>y("offline"))},{default:i(()=>[s(v,{class:"mr-1"},{default:i(()=>[s(ie)]),_:1}),C(" "+o(e.$t("离线"))+"（"+o(r.offline)+"） ",1)]),_:1},8,["class"])]),l("div",null,[s(_e,{modelValue:O.value,"onUpdate:modelValue":t[3]||(t[3]=n=>O.value=n),style:{width:"240px"},placeholder:e.$t("搜索矿工"),onInput:se},{prefix:i(()=>[s(v,{class:"el-input__icon"},{default:i(()=>[s(re)]),_:1})]),_:1},8,["modelValue","placeholder"])])])):T("",!0),_(a).ACTIVE_SUB_ACCOUNT_ID!==null?(m(),p("div",ot,[g((m(),Se(ce,{data:B.value,class:"w-full mt-5 shadow-[0_0_0_1px_rgba(107,114,128,.3)] rounded-md",stripe:"","row-class-name":"table-row-class","empty-text":e.$t("无矿工"),onRowClick:le},{default:i(()=>[s(E,{prop:"status",label:" ",width:"20"},{default:i(n=>[n.row.status=="active"?(m(),p("div",it)):T("",!0),n.row.status=="inactive"||n.row.status=="unactive"?(m(),p("div",rt)):T("",!0)]),_:1}),s(E,{prop:"workerName",label:e.$t("矿工"),sortable:""},null,8,["label"]),s(E,{prop:"realtimeHashrate",label:e.$t("10分钟算力"),sortable:""},{default:i(n=>[C(o(_(x)(_(d).ACTIVE_COIN,n.row.realtimeHashrate).num)+" "+o(_(x)(_(d).ACTIVE_COIN,n.row.realtimeHashrate).unit),1)]),_:1},8,["label"]),s(E,{prop:"avgHashrate1440",label:e.$t("24小时算力"),sortable:""},{default:i(n=>[C(o(_(x)(_(d).ACTIVE_COIN,n.row.avgHashrate1440).num)+" "+o(_(x)(_(d).ACTIVE_COIN,n.row.avgHashrate1440).unit),1)]),_:1},8,["label"]),s(E,{prop:"avgRejectrate1440",label:e.$t("拒绝率"),sortable:""},{default:i(n=>[C(o((n.row.avgRejectrate1440*100).toFixed(2))+" % ",1)]),_:1},8,["label"]),s(E,{prop:"lastShareTime",label:e.$t("最近提交日期")},{default:i(n=>[C(o(_(be)(n.row.lastShareTime*1e3).format("MMMM Do YYYY, h:mm:ss a")),1)]),_:1},8,["label"])]),_:1},8,["data","empty-text"])),[[de,$.value]]),l("div",_t,[s(ue,{"current-page":k.value,"onUpdate:currentPage":t[4]||(t[4]=n=>k.value=n),"page-size":N.value,"onUpdate:pageSize":t[5]||(t[5]=n=>N.value=n),size:K.value,disabled:q.value,background:J.value,layout:"prev, pager, next",total:Q.value,onSizeChange:Z,onCurrentChange:ee},null,8,["current-page","page-size","size","disabled","background","total"])])])):T("",!0)])])}}},It=fe(ct,[["__scopeId","data-v-56d9b049"]]);export{It as default};
