import{n as k,h as Y,q as G,f as _,p as I,s as L,K as U,v as M,c as P,b as e,x as p,A as E,u as d,l as D,D as q,y as T,t as n,B as Q,w as J,G as N,H as b,z as B,I as A,J as j,j as K,o as R}from"./index-BWeRxd06.js";import{E as W}from"./index-myy9ilv1.js";const X={class:"over-container"},Z={class:"w-full h-40 relative z-0"},tt={class:"pointer-events-none absolute inset-0 w-full h-full p-4"},et={class:"text-5xl font-bold transition-all"},st={class:"text-lime-500"},it={class:"overflow-hidden z-0 bg-zinc-900 relative w-full h-full"},at={class:"p-4 -translate-y-12"},nt={class:"p-4 grid gap-3 grid-cols-2 rounded-lg w-full border border-zinc-700 bg-zinc-800"},lt={class:"text-sm text-zinc-200"},ot={class:"flex justify-center font-bold"},rt={class:"text-lime-500"},dt={class:"text-sm text-zinc-200"},ft={class:"flex justify-center items-center font-bold"},ut={class:"mr-2"},_t={class:"text-lime-500"},ct={class:"text-zinc-400"},xt={class:"text-sm text-zinc-200"},ht={class:"flex justify-center font-bold"},vt={class:"text-sm text-zinc-200"},Ct={class:"flex justify-center font-bold"},mt={class:"py-4"},It={class:"flex mb-2 items-center justify-between text-xs text-zinc-400"},pt={class:"flex mb-2 items-center justify-between text-xs text-zinc-400"},Et={class:"flex mb-2 items-center justify-between text-xs text-zinc-400"},Tt={class:"flex mb-2 items-center justify-between text-xs text-zinc-400"},Nt={class:"flex mb-2 items-center justify-between text-xs text-zinc-400"},bt={class:"flex mb-2 items-center justify-between text-xs text-zinc-400"},At={class:"flex mb-2 items-center justify-between text-xs text-zinc-400"},Ot={class:"flex mb-2 items-center justify-between text-xs text-zinc-400"},zt={__name:"DashBoard",setup(gt){const a=k(),f=Y(),O=G();K();const g=_(!1),y=_(!1),V=_(!1),h=_(!1);_(!1);const z=_("hourly"),w=_(null),F=I({color:"rgba(161, 161, 170, 1)"}),v=I({series:[{name:"全部子账号",data:[],xAxisData:[]}],showLegend:!1,coin:""}),s=I({online:0,offline:0,totalProfit:0,unpaidProfit:0,yesterdayProfit:0,currentHash:0,hash24:0,estimateProfit:0}),S=()=>{for(let i in s)s[i]=0},H=L(()=>{let i="计算中...",t=O.QUOTES[a.ACTIVE_COIN],r=O.RATES.CNY,o=s.totalProfit;return t&&r&&o?i="¥ "+(Number(o)*t*r).toFixed(4):i="¥ 0.0000",i}),x=i=>Number(i).toFixed(8),$=i=>{j.locale("zh-cn");let t=i.start_time||i.startTime,r=i.hashrates,o={data:[],time:[]};for(let u=0;u<r.length;u++){let c;z.value=="hourly"?c=t+6e5*u:c=t+864e5*u,o.data.push(r[u]),o.time.push(j(c).format("MMMM Do YYYY, h:mm:ss a"))}return o},C=i=>{y.value=!0,g.value=!0,V.value=!0,N({url:b.get_account_info.replace("{coin}",a.ACTIVE_COIN).replace("{sid}",i)}).then(t=>{if(y.value=!1,g.value=!1,t.data.status==0){let r=B(a.ACTIVE_COIN,t.data.data.hashrate),o=B(a.ACTIVE_COIN,t.data.data.avg_hashrate1440);s.currentHash=`${r.num} ${r.unit}`,s.hash24=`${o.num} ${o.unit}`,s.online=t.data.data.online,s.offline=t.data.data.offline}else A.error("获取账户信息失败。")}),N({url:b.get_account_profit.replace("{coin}",a.ACTIVE_COIN).replace("{sid}",i)}).then(t=>{if(V.value=!1,t.data.status==0){let r=0,o=0,u=0,c=0;t.data.data.forEach(l=>{l.profit!=null&&l.status=="all"&&(r=l.profit?l.profit:0),l.profit!=null&&l.status=="yesterday"&&(o=l.profit?l.profit:0),l.profit!=null&&l.status=="unpaid"&&(u=l.profit?l.profit:0),l.profit!=null&&l.status=="estimate_profit"&&(c=l.profit?l.profit:0)}),s.unpaidProfit=u,s.yesterdayProfit=o,s.totalProfit=r,s.estimateProfit=c}else A.error("获取收益失败。")})},m=()=>{f.ACTIVE_SUB_ACCOUNT_ID===null&&f.OBSERVER||a.GET_FEE_COIN()||(h.value=!0,N({method:"get",url:b.get_account_hash.replace("{sid}",f.ACTIVE_SUB_ACCOUNT_ID).replace("{coin}",a.ACTIVE_COIN).replace("{mode}",z.value)}).then(i=>{if(h.value=!1,i.data.status==0){let t=$(i.data.data);v.series=[{name:`${a.ACTIVE_COIN}算力`,data:t.data,xAxisData:t.time}],v.coin=a.ACTIVE_COIN,w.value.initChart()}else A.error("获取图表失败。")}))};return U(()=>f.ACTIVE_SUB_ACCOUNT_ID,(i,t)=>{S(),i!==null&&(C(f.ACTIVE_SUB_ACCOUNT_ID),m())}),U(()=>a.ACTIVE_COIN,(i,t)=>{S(),i!==null&&(C(f.ACTIVE_SUB_ACCOUNT_ID),m())}),M(()=>{f.ACTIVE_SUB_ACCOUNT_ID!==null&&(C(f.ACTIVE_SUB_ACCOUNT_ID),m())}),(i,t)=>{const r=W,o=Q;return R(),P("div",X,[e("div",Z,[p(D(q,{chartConfig:v,ref_key:"hashChartRef",ref:w},null,8,["chartConfig"]),[[E,!d(a).GET_FEE_COIN()]]),p(e("div",tt,[e("h2",et,[e("span",st,n(s.currentHash),1),t[0]||(t[0]=T(" / S "))])],512),[[E,!d(a).GET_FEE_COIN()]]),p((R(),P("div",it,[D(r,{content:`挖${d(a).GET_FEE_COIN_BY_COIN()}赠${d(a).ACTIVE_COIN}`,font:F},{default:J(()=>t[1]||(t[1]=[e("div",{style:{height:"400px"}},null,-1)])),_:1},8,["content","font"])])),[[E,d(a).GET_FEE_COIN()],[o,h.value]])]),e("div",at,[e("div",nt,[e("div",lt,[t[2]||(t[2]=e("div",{class:"text-zinc-400 text-xs mb-2"}," 24小时平均算力 ",-1)),e("div",ot,[e("span",rt,n(s.hash24||0),1)])]),e("div",dt,[t[5]||(t[5]=e("div",{class:"text-zinc-400 text-xs mb-2"}," 矿机 ",-1)),e("div",ft,[e("div",ut,[t[3]||(t[3]=T(" 在线 ")),e("span",_t,n(s.online||0),1)]),e("div",null,[t[4]||(t[4]=T(" 离线 ")),e("span",ct,n(s.offline||0),1)])])]),e("div",xt,[t[6]||(t[6]=e("div",{class:"text-zinc-400 text-xs mb-2"}," 总收益 ",-1)),e("div",ht,n(x(s.totalProfit))+" "+n(d(a).ACTIVE_COIN),1)]),e("div",vt,[t[7]||(t[7]=e("div",{class:"text-zinc-400 text-xs mb-2"}," 今日已挖（预估） ",-1)),e("div",Ct,n(x(s.estimateProfit))+" "+n(d(a).ACTIVE_COIN),1)])]),e("div",mt,[e("div",It,[t[8]||(t[8]=e("div",null," 24H算力 ",-1)),e("div",null,n(s.hash24||0),1)]),e("div",pt,[t[9]||(t[9]=e("div",null," 10分钟算力 ",-1)),e("div",null,n(s.currentHash||0),1)]),e("div",Et,[t[10]||(t[10]=e("div",null," 活跃设备 ",-1)),e("div",null,n(s.online||0),1)]),e("div",Tt,[t[11]||(t[11]=e("div",null," 离线设备 ",-1)),e("div",null,n(s.offline||0),1)]),e("div",Nt,[t[12]||(t[12]=e("div",null," 总收益 ",-1)),e("div",null,n(x(s.totalProfit))+" "+n(d(a).ACTIVE_COIN),1)]),e("div",bt,[t[13]||(t[13]=e("div",null," 总收益预估CNY ",-1)),e("div",null,n(H.value),1)]),e("div",At,[t[14]||(t[14]=e("div",null," 未支付收益 ",-1)),e("div",null,n(x(Number(s.unpaidProfit)+Number(s.estimateProfit)))+" "+n(d(a).ACTIVE_COIN),1)]),e("div",Ot,[t[15]||(t[15]=e("div",null," 今日已挖 ",-1)),e("div",null,n(x(s.estimateProfit))+" "+n(d(a).ACTIVE_COIN),1)])])])])}}};export{zt as default};
