import{J as H,i as P,g as z,k as G,e as b,l as J,c as r,o as l,a as i,j as n,t,w as o,f as k,b as c,aR as Q,aS as K,F as S,z as B,u as h,aT as W,a$ as q,s as v,p as X,aN as Z,x as ee,aQ as te,G as ae,D as m,B as E,C as T}from"./index-BkAjzXa5.js";import{a as se,E as le}from"./el-table-column-C8go28Lx.js";/* empty css                   */const oe={class:"title text-stone-50 mb-5"},ne={class:"mb-5"},ue={class:"text-xs text-gray-400"},re={class:"flex items-center"},ie=["src"],de={key:0,class:"text-xs text-gray-400"},ce={class:"text-green-400"},me={key:1,class:"text-xs text-gray-400"},_e={key:2,class:"text-xs text-gray-400"},pe={class:"text-yellow-400"},ve={key:3,class:"text-xs text-gray-400"},be={key:4,class:"text-xs text-gray-400"},fe={key:0},ye=["onClick"],Ce={__name:"SmallMoney",setup(ge){const{t:d}=H(),A=P("payAddress-show"),D=z(),I=G(),M=b(!1),f=b(!1),_=b(""),p=b(""),y=b(!1),s=J({status:999,time:0,balance:0}),$=b([]),x=()=>{s.status=999,s.time=0,s.balance=0,$.value=[]},F=e=>{let u=Date.now();return ae(u-e).format("YYYY-MM-DD HH:mm:ss")},U=()=>{if(s.status!=0){m.error(d("提币失败"));return}y.value=!0,E.post(T.p_submit_small_money,{sid:_.value,coin:p.value}).then(e=>{if(e.status!=200){m.error(d("提币失败"));return}e.data.status==0?(m.success(d("提币成功")),N()):m.error(d("提币失败")),y.value=!1}).catch(e=>{y.value=!1,m.error(d("提币失败"))})},Y=()=>{E.post(T.p_query_small_money_logs,{sid:_.value,coin:p.value}).then(e=>{if(e.status!=200){m.error(d("获取数据失败"));return}$.value=e.data.data})},N=()=>{if(!_.value||!p.value){m.error(d("请先选择子账号和币种"));return}f.value=!0,E.post(T.p_query_small_money,{sid:_.value,coin:p.value}).then(e=>{if(f.value=!1,e.status!=200){m.error(d("获取数据失败"));return}s.status=e.data.data[0],s.time=e.data.data[1],s.balance=e.data.data[1]}).catch(e=>{f.value=!1,m.error(d("获取数据失败"))}),Y()};return(e,u)=>{const C=W,V=K,g=Q,w=le,R=se,L=Z,j=te;return l(),r(S,null,[i("h1",oe,t(e.$t("小额提币")),1),i("div",ne,[i("p",ue,t(e.$t("每个子账号下的每个币种，每个月可进行一次自助小额提币，旧版节点余额也可在此自助提币。")),1)]),n(j,{"label-width":"auto"},{default:o(()=>[n(g,{label:e.$t("提币子账号")},{default:o(()=>[n(V,{placeholder:e.$t("请先选择子账号"),disabled:M.value,modelValue:_.value,"onUpdate:modelValue":u[0]||(u[0]=a=>_.value=a),onChange:x},{default:o(()=>[(l(!0),r(S,null,B(h(D).SUB_ACCOUNT,(a,O)=>(l(),k(C,{label:a.name,value:a.id},null,8,["label","value"]))),256))]),_:1},8,["placeholder","disabled","modelValue"])]),_:1},8,["label"]),n(g,{label:e.$t("币种")},{default:o(()=>[n(V,{placeholder:e.$t("请先选择币种"),modelValue:p.value,"onUpdate:modelValue":u[1]||(u[1]=a=>p.value=a),onChange:x},{default:o(()=>[(l(!0),r(S,null,B(h(I).SMALL_MONEY_COIN_LIST,(a,O)=>(l(),k(C,{label:a.name,value:a.coin},{default:o(()=>[i("div",re,[i("img",{src:`./icon-image/icon-${h(q).transPoolCoinOriginName(a.coin)}.png`,class:"block h-[16px] mr-1"},null,8,ie),i("span",null,t(a.name),1)])]),_:2},1032,["label","value"]))),256))]),_:1},8,["placeholder","modelValue"])]),_:1},8,["label"]),s.status!=999?(l(),k(g,{key:0,label:e.$t("查询结果")},{default:o(()=>[s.status==0?(l(),r("div",de,[v(t(e.$t("余额"))+"：",1),i("span",ce,t(s.balance),1),v("，"+t(e.$t("可提币"))+", "+t(e.$t("请点击小额提币按钮开始提币。")),1)])):c("",!0),s.status==-1?(l(),r("div",me,t(e.$t("未查询到余额, 无法提币。")),1)):c("",!0),s.status==-2?(l(),r("div",_e,[v(t(e.$t("查询到余额, 但未绑定支付地址, 请先绑定支付地址, ")),1),i("span",{class:"text-yellow-400 cursor-pointer underline",onClick:u[2]||(u[2]=a=>h(A)({oldCoin:!0,sid:_.value,coin:p.value}))},t(e.$t("点击绑定支付地址")),1),v(", "+t(e.$t("旧版余额请绑定旧版币种方可继续提币, 绑定后请")),1),i("span",pe,t(e.$t("重新查询")),1),u[3]||(u[3]=v("。"))])):c("",!0),s.status==-3?(l(),r("div",ve,t(e.$t("距离当前子账号对应币种上次小额提币未满1个月, 无法再次提币, 上次提币日期"))+t(F(s.time))+"。",1)):c("",!0),s.status==-4?(l(),r("div",be,t(e.$t("权限不足, 无法提币。")),1)):c("",!0)]),_:1},8,["label"])):c("",!0),$.value.length?(l(),k(g,{key:1,label:e.$t("自助提币日志")},{default:o(()=>[n(R,{data:$.value,style:{width:"100%"}},{default:o(()=>[n(w,{prop:"updated_at",label:e.$t("提交日期")},null,8,["label"]),n(w,{prop:"amount",label:e.$t("提币数量")},{default:o(a=>[i("span",null,t(a.row.amount||e.$t("支付后展示")),1)]),_:1},8,["label"]),n(w,{prop:"status",label:e.$t("交易状态")},{default:o(a=>[a.row.status==0?(l(),r("span",fe,t(e.$t("等待支付")),1)):c("",!0),a.row.status==1?(l(),r("span",{key:1,class:"text-green-400 cursor-pointer underline",onClick:O=>h(q).copyText(a.row.hash)},t(e.$t("支付成功（点击复制交易哈希）")),9,ye)):c("",!0)]),_:1},8,["label"])]),_:1},8,["data"])]),_:1},8,["label"])):c("",!0),n(g,{label:" "},{default:o(()=>[n(L,{class:"ml-0",text:"",bg:"",type:"primary",onClick:N,disabled:f.value,loading:f.value},{default:o(()=>[v(t(e.$t("查询")),1)]),_:1},8,["disabled","loading"]),X(n(L,{class:"ml-0",text:"",bg:"",type:"success",onClick:U,disabled:y.value,loading:y.value},{default:o(()=>[v(t(e.$t("小额提币")),1)]),_:1},8,["disabled","loading"]),[[ee,s.status==0]])]),_:1})]),_:1})],64)}}};export{Ce as default};
