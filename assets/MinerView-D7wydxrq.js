import{_ as Z,J as ee,k as te,g as se,e as i,l as ae,K as j,n as ne,c as v,a as s,j as A,w as R,O as le,L as k,x as n,b as U,u,s as oe,A as ie,F as re,B as ce,D as M,G as L,H as P,y as I,h as de,aV as ue,p as _e,o as f,t as ve}from"./index-D6Gy3zvT.js";import{E as fe}from"./el-pagination-BYk5nNjh.js";const Ce={class:"over-container"},he={class:"p-4"},Ie={class:"pt-4 px-4"},xe={class:"border-t border-b py-2 text-zinc-300 border-zinc-700 bg-zinc-800 border-b-0 rounded-tl-2xl rounded-tr-2xl"},pe={class:"flex justify-around items-center"},ge={class:"text-zinc-300 text-sm mb-1"},Te={class:"text-zinc-200 text-xs"},me={class:"text-zinc-300 text-sm mb-1"},Ae={class:"text-zinc-200 text-xs"},Ue={class:"text-zinc-300 text-sm mb-1"},we={class:"text-zinc-200 text-xs"},be={class:"mb-10 border-t border-b border-zinc-700 bg-zinc-800 rounded-bl-2xl rounded-br-2xl"},Ee={key:0,class:"relative"},Ne={class:"flex py-2 text-xs text-zinc-300 border-zinc-700"},Se={class:"w-28 flex"},Ve={class:"w-20 flex"},Oe={class:"w-20 flex"},ke={class:"w-20 flex"},ze={class:"flex py-2 text-xs text-zinc-300 border-b border-zinc-700"},Be={class:"w-28 flex"},ye={class:"w-20 flex"},De={class:"w-20 flex"},$e={class:"miner-box"},He={key:0,class:"miner-item flex justify-center items-center text-xs py-4 text-zinc-400"},je=["onClick"],Re={class:"w-5 flex justify-center"},Me={key:0,class:"online"},Le={key:1,class:"offline"},Pe={class:"w-28 flex"},Fe={class:"w-20 flex"},We={class:"w-20 flex"},Ke={class:"w-20 flex"},Ge={class:"demo-pagination-block"},Je={__name:"MinerView",setup(qe){const{t:z}=ee(),F=de();ue();const c=te(),a=se(),C=i("all"),g=i(""),w=i(!1),B=i(!1),y=i(!1),b=i(0),E=i(0),N=i(0),S=i(1),T=i(100),W=i("default"),K=i(!1),G=i(!1),V=i(0),_=ae({online:0,offline:0,currentHash:0,hash24:0}),D=i([]),J=e=>{let t=e.workerId||"unknow",o=e.workerName||"unknow";F.push({name:"minerinfo",params:{workerName:o,workerId:t,avgHashrate1440:e.avgHashrate1440,avgRejectrate1440:e.avgRejectrate1440,lastShareTime:e.lastShareTime,realtimeHashrate:e.realtimeHashrate,status:e.status,sid:a.ACTIVE_SUB_ACCOUNT_ID}})},m=e=>{y.value=!0,B.value=!0,M({url:L.get_account_info.replace("{coin}",c.ACTIVE_COIN).replace("{sid}",e)}).then(t=>{if(y.value=!1,B.value=!1,t.data.status==0){let o=I(c.ACTIVE_COIN,t.data.data.hashrate),h=I(c.ACTIVE_COIN,t.data.data.avg_hashrate1440);_.currentHash=`${o.num} ${o.unit}`,_.hash24=`${h.num} ${h.unit}`,_.online=t.data.data.online,_.offline=t.data.data.offline}else P.error(z("获取账户信息失败。"))})},q=e=>{console.log(`${e} items per page`)},Q=e=>{p(a.ACTIVE_SUB_ACCOUNT_ID)},x=i([]),$=()=>{for(let e in _)_[e]=0;x.value=[]},p=e=>{e&&(w.value=!0,M({method:"get",url:L.get_workers.replace("{coin}",c.ACTIVE_COIN).replace("{sid}",e)}).then(t=>{t.data.status==0?(D.value=t.data.data,H(t.data.data)):P.error(z("获取矿工信息失败！")),w.value=!1}))},X=e=>{H(D.value)},H=e=>{x.value=[],V.value=0,b.value=0,E.value=0,N.value=0;let t=[];V.value=e.length,b.value=e.length;for(let r=0;r<e.length;r++){let d=e[r];d.status!="active"?N.value+=1:E.value+=1,!(g.value&&d.workerName.indexOf(g.value)==-1)&&(C.value=="all"&&t.push(d),C.value=="online"&&d.status=="active"&&t.push(d),C.value=="offline"&&d.status!="active"&&t.push(d))}let o=(S.value-1)*T.value,h=o+T.value;t=t.slice(o,h),t.forEach(r=>{x.value.push({workerName:r.workerName,realtimeHashrate:r.realtimeHashrate,avgHashrate1440:r.avgHashrate1440,avgRejectrate1440:r.avgRejectrate1440,lastShareTime:r.lastShareTime,status:r.status,workerId:r.workerId})})},O=e=>{C.value=e,p(a.ACTIVE_SUB_ACCOUNT_ID),m(a.ACTIVE_SUB_ACCOUNT_ID)};return j(()=>a.SUB_ACCOUNT,(e,t)=>{$();const o=a.SUB_ACCOUNT;a.ACTIVE_SUB_ACCOUNT_ID==null&&o[0]&&a.SET_ACTIVE_SUB_ACCOUNT_ID(o[0].id),o[0]&&(p(a.ACTIVE_SUB_ACCOUNT_ID),m(a.ACTIVE_SUB_ACCOUNT_ID))},{deep:!0}),j(()=>c.ACTIVE_COIN,(e,t)=>{$();const o=a.SUB_ACCOUNT;a.ACTIVE_SUB_ACCOUNT_ID==null&&o[0]&&a.SET_ACTIVE_SUB_ACCOUNT_ID(o[0].id),o[0]&&(p(a.ACTIVE_SUB_ACCOUNT_ID),m(a.ACTIVE_SUB_ACCOUNT_ID))},{deep:!0}),ne(()=>{const e=a.SUB_ACCOUNT;a.ACTIVE_SUB_ACCOUNT_ID==null&&e[0]&&a.SET_ACTIVE_SUB_ACCOUNT_ID(e[0].id),e[0]&&(p(a.ACTIVE_SUB_ACCOUNT_ID),m(a.ACTIVE_SUB_ACCOUNT_ID))}),(e,t)=>{const o=_e("search"),h=ve,r=le,d=fe,Y=ie;return f(),v("div",Ce,[s("div",he,[A(r,{class:"miner-view-search",modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=l=>g.value=l),onInput:X,size:"large",placeholder:e.$t("输入矿工名搜索")},{suffix:R(()=>[A(h,{class:"el-input__icon"},{default:R(()=>[A(o)]),_:1})]),_:1},8,["modelValue","placeholder"])]),s("div",Ie,[s("div",xe,[s("div",pe,[s("div",{onClick:t[1]||(t[1]=l=>O("all")),class:k(["mode-item border-r border-zinc-600 flex items-center justify-center flex-col w-1/3",{active:C.value=="all"}])},[s("div",ge,n(e.$t("全部")),1),s("div",Te,n(b.value),1)],2),s("div",{onClick:t[2]||(t[2]=l=>O("online")),class:k(["mode-item border-r border-zinc-600 flex items-center justify-center flex-col w-1/3",{active:C.value=="online"}])},[s("div",me,n(e.$t("在线")),1),s("div",Ae,n(E.value),1)],2),s("div",{onClick:t[3]||(t[3]=l=>O("offline")),class:k(["mode-item flex items-center justify-center w-1/3 flex-col",{active:C.value=="offline"}])},[s("div",Ue,n(e.$t("离线")),1),s("div",we,n(N.value),1)],2)])]),s("div",be,[u(a).ACTIVE_SUB_ACCOUNT_ID!==null?(f(),v("div",Ee,[s("div",Ne,[t[6]||(t[6]=s("div",{class:"w-5 flex justify-center"},null,-1)),s("div",Se,n(e.$t("矿工名")),1),s("div",Ve,n(e.$t("10分钟算力")),1),s("div",Oe,n(e.$t("24小时算力")),1),s("div",ke,n(e.$t("拒绝率")),1)]),s("div",ze,[t[7]||(t[7]=s("div",{class:"w-5 flex justify-center"},null,-1)),s("div",Be,n(e.$t("总计")),1),s("div",ye,n(_.currentHash),1),s("div",De,n(_.hash24),1),t[8]||(t[8]=s("div",{class:"w-20 flex"}," - ",-1))]),s("div",$e,[oe((f(),v("div",null,[x.value.length?U("",!0):(f(),v("div",He,n(e.$t("无活跃矿工")),1)),(f(!0),v(re,null,ce(x.value,l=>(f(),v("div",{class:"miner-item flex justify-between items-center text-xs py-4 text-zinc-400",onClick:Qe=>J(l)},[s("div",Re,[l.status=="active"?(f(),v("div",Me)):U("",!0),l.status=="inactive"?(f(),v("div",Le)):U("",!0)]),s("div",Pe,n(l.workerName),1),s("div",Fe,n(u(I)(u(c).ACTIVE_COIN,l.realtimeHashrate).num)+" "+n(u(I)(u(c).ACTIVE_COIN,l.realtimeHashrate).unit),1),s("div",We,n(u(I)(u(c).ACTIVE_COIN,l.avgHashrate1440).num)+" "+n(u(I)(u(c).ACTIVE_COIN,l.avgHashrate1440).unit),1),s("div",Ke,n((l.avgRejectrate1440*100).toFixed(2))+" % ",1)],8,je))),256))])),[[Y,w.value]])]),s("div",Ge,[A(d,{"current-page":S.value,"onUpdate:currentPage":t[4]||(t[4]=l=>S.value=l),"page-size":T.value,"onUpdate:pageSize":t[5]||(t[5]=l=>T.value=l),size:W.value,disabled:K.value,background:G.value,layout:"prev, pager, next",total:V.value,onSizeChange:q,onCurrentChange:Q},null,8,["current-page","page-size","size","disabled","background","total"])])])):U("",!0)])])])}}},Ze=Z(Je,[["__scopeId","data-v-d9c2486f"]]);export{Ze as default};
