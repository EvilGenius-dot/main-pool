import{_ as he,K as pe,n as Ie,h as ge,f as _,p as Te,i as Y,L as G,v as Ae,k as S,c as p,o as f,b as l,d as g,u as r,F as Ue,C as Ee,M as B,l as s,y as d,w as i,m as we,t as o,O as xe,x as T,A as w,N as Ne,P as Se,B as be,g as Oe,z as x,J as Ve,G as K,H as J,I as q}from"./index-LtxatZno.js";import{E as ke}from"./el-pagination-BgV8Fka8.js";import{E as Be,a as De}from"./el-table-column-CUig5FrB.js";import{E as $e}from"./el-progress-DOB2SOwg.js";import{_ as ze}from"./online-BeAw_8w7.js";import{_ as Q}from"./CPU-Cl-hhvhq.js";const He={class:"w-full h-full"},ye={class:"h-full py-4 max-w-[90rem] mx-auto px-6 bg-zinc-950"},Me={key:0,class:"flex gap-6"},Fe={class:"flex flex-col gap-6 flex-grow"},Re={class:"user-list w-full flex gap-3 text-slate-300 text-sm flex-wrap"},je=["onClick"],Le={key:1,class:"text-slate-300 text-sm flex justify-center items-center"},Pe={key:2,class:"text-slate-300 text-sm px-4 py-3"},We={class:"grid gap-6 grid-cols-3 max-[800px]:grid-cols-1 mt-5"},Ye={class:"flex"},Ge={class:"flex-1 overflow-hidden min-w-0 break-words"},Ke={class:"flex items-center text-zinc-300 text-xs mb-2"},Je={class:"text-zinc-50 text-lg font-bold"},qe={class:"pl-5"},Qe={class:"text-lime-500"},Xe={class:"text-zinc-50"},Ze={class:"flex"},et={class:"flex-1 overflow-hidden min-w-0 break-words"},tt={class:"flex items-center text-zinc-300 text-xs mb-2"},at={class:"text-zinc-50 text-lg font-bold"},st={class:"flex"},lt={class:"flex-1 overflow-hidden min-w-0 break-words"},nt={class:"flex items-center text-zinc-300 text-xs mb-2"},ot={class:"text-zinc-50 text-lg font-bold"},it={key:3,class:"mt-5 flex justify-between items-center"},rt={key:4},ct={key:0,class:"online"},_t={key:1,class:"offline"},ut={class:"demo-pagination-block mt-5"},dt={__name:"MinerView",setup(Ct){const{t:j}=pe(),C=Ie(),a=ge(),I=_("all"),b=_(""),D=_(!1),O=_(!1),A=_(!1),$=_(0),z=_(0),H=_(0),y=_(1),V=_(100),X=_("default"),Z=_(!1),ee=_(!1),M=_(0),m=Te({online:0,offline:0,currentHash:0,hash24:0}),L=_([]),te=Y("minerHashChart-show"),N=e=>{C.GET_FEE_COIN(C.ACTIVE_COIN)||(A.value=!0,O.value=!0,K({url:J.get_account_info.replace("{coin}",C.ACTIVE_COIN).replace("{sid}",e)}).then(t=>{if(A.value=!1,O.value=!1,t.data.status==0){let u=x(C.ACTIVE_COIN,t.data.data.hashrate),h=x(C.ACTIVE_COIN,t.data.data.avg_hashrate1440);m.currentHash=`${u.num} ${u.unit}`,m.hash24=`${h.num} ${h.unit}`,m.online=t.data.data.online,m.offline=t.data.data.offline}else q.error(j("获取账户信息失败。"))}))},ae=e=>{console.log(`${e} items per page`)},se=e=>{U(a.ACTIVE_SUB_ACCOUNT_ID)},le=Y("createSubAccount-show"),k=_([]),P=()=>{for(let e in m)m[e]=0;k.value=[]},ne=e=>{a.SET_ACTIVE_SUB_ACCOUNT_ID(e),U(e),N(a.ACTIVE_SUB_ACCOUNT_ID)},U=e=>{!e||C.GET_FEE_COIN(C.ACTIVE_COIN)||(D.value=!0,K({method:"get",url:J.get_workers.replace("{coin}",C.ACTIVE_COIN).replace("{sid}",e)}).then(t=>{t.data.status==0?(L.value=t.data.data,W(t.data.data)):q.error(j("获取矿工信息失败！")),D.value=!1}))},oe=e=>{W(L.value)},W=e=>{k.value=[],M.value=0,$.value=0,z.value=0,H.value=0;let t=[];M.value=e.length,$.value=e.length;for(let c=0;c<e.length;c++){let v=e[c];v.status!="active"?H.value+=1:z.value+=1,!(b.value&&v.workerName.indexOf(b.value)==-1)&&(I.value=="all"&&t.push(v),I.value=="online"&&v.status=="active"&&t.push(v),I.value=="offline"&&v.status!="active"&&t.push(v))}let u=(y.value-1)*V.value,h=u+V.value;t=t.slice(u,h),t.forEach(c=>{k.value.push({workerName:c.workerName,realtimeHashrate:c.realtimeHashrate,avgHashrate1440:c.avgHashrate1440,avgRejectrate1440:c.avgRejectrate1440,lastShareTime:c.lastShareTime,status:c.status,workerId:c.workerId})})},ie=e=>{te(e)},F=e=>{I.value=e,U(a.ACTIVE_SUB_ACCOUNT_ID),N(a.ACTIVE_SUB_ACCOUNT_ID)};return G(()=>a.SUB_ACCOUNT,(e,t)=>{P();const u=a.SUB_ACCOUNT;a.ACTIVE_SUB_ACCOUNT_ID==null&&u[0]&&a.SET_ACTIVE_SUB_ACCOUNT_ID(u[0].id),u[0]&&(U(a.ACTIVE_SUB_ACCOUNT_ID),N(a.ACTIVE_SUB_ACCOUNT_ID))},{deep:!0}),G(()=>C.ACTIVE_COIN,(e,t)=>{P();const u=a.SUB_ACCOUNT;a.ACTIVE_SUB_ACCOUNT_ID==null&&u[0]&&a.SET_ACTIVE_SUB_ACCOUNT_ID(u[0].id),u[0]&&(U(a.ACTIVE_SUB_ACCOUNT_ID),N(a.ACTIVE_SUB_ACCOUNT_ID))},{deep:!0}),Ae(()=>{const e=a.SUB_ACCOUNT;a.ACTIVE_SUB_ACCOUNT_ID==null&&e[0]&&a.SET_ACTIVE_SUB_ACCOUNT_ID(e[0].id),e[0]&&(U(a.ACTIVE_SUB_ACCOUNT_ID),N(a.ACTIVE_SUB_ACCOUNT_ID))}),(e,t)=>{const u=S("UserFilled"),h=we,c=xe,v=$e,R=Ne,re=S("Histogram"),ce=S("Finished"),_e=S("WarnTriangleFilled"),ue=S("search"),de=Se,E=Be,Ce=De,ve=ke,fe=be;return f(),p("div",He,[l("div",ye,[r(a).SUB_ACCOUNT.length?(f(),p("div",Me,[l("div",Fe,[l("div",Re,[(f(!0),p(Ue,null,Ee(r(a).SUB_ACCOUNT,(n,me)=>(f(),p("div",{key:me,class:B(["flex items-center py-2 px-4 rounded-md hover:cursor-pointer hover:bg-zinc-800 active:bg-zinc-500 transition-all",{active:r(a).ACTIVE_SUB_ACCOUNT_ID===n.id}]),onClick:vt=>ne(n.id)},[s(h,{class:"mr-1"},{default:i(()=>[s(u)]),_:1}),d(" "+o(n.name),1)],10,je))),128))])])])):g("",!0),r(a).SUB_ACCOUNT.length?g("",!0):(f(),p("div",Le,[d(o(e.$t("尚未创建子账号, 请先")),1),s(c,{class:"menu-item active ml-1",onClick:r(le)},{default:i(()=>[d(o(e.$t("创建")),1)]),_:1},8,["onClick"])])),r(a).ACTIVE_SUB_ACCOUNT_ID===null?(f(),p("div",Pe,o(e.$t("请在上方选择一个子账号开始查询矿工。")),1)):g("",!0),l("div",We,[s(R,null,{default:i(()=>[l("div",Ye,[l("div",Ge,[l("div",Ke,[t[6]||(t[6]=l("img",{src:ze,class:"h-4 mr-1"},null,-1)),d(" "+o(e.$t("活跃 / 离线")),1)]),T(s(v,{class:"h-7",percentage:50,indeterminate:!0,"show-text":!1},null,512),[[w,O.value]]),l("div",Je,[T(l("div",qe,[l("span",Qe,o(m.online),1),t[7]||(t[7]=d(" / ")),l("span",Xe,o(m.offline),1)],512),[[w,!O.value]])])])])]),_:1}),s(R,null,{default:i(()=>[l("div",Ze,[l("div",et,[l("div",tt,[t[8]||(t[8]=l("img",{src:Q,class:"h-4 mr-1"},null,-1)),d(" "+o(e.$t("当前算力")),1)]),T(s(v,{class:"h-7",percentage:50,indeterminate:!0,"show-text":!1},null,512),[[w,A.value]]),l("div",at,[T(l("div",{class:"pl-5"},o(m.currentHash),513),[[w,!A.value]])])])])]),_:1}),s(R,null,{default:i(()=>[l("div",st,[l("div",lt,[l("div",nt,[t[9]||(t[9]=l("img",{src:Q,class:"h-4 mr-1"},null,-1)),d(" "+o(e.$t("24H算力")),1)]),T(s(v,{class:"h-7",percentage:50,indeterminate:!0,"show-text":!1},null,512),[[w,A.value]]),l("div",ot,[T(l("div",{class:"pl-5"},o(m.hash24),513),[[w,!A.value]])])])])]),_:1})]),r(a).ACTIVE_SUB_ACCOUNT_ID!==null?(f(),p("div",it,[l("div",null,[s(c,{class:B(["menu-item ml-1",{active:I.value=="all"}]),onClick:t[0]||(t[0]=n=>F("all"))},{default:i(()=>[s(h,{class:"mr-1"},{default:i(()=>[s(re)]),_:1}),d(" "+o(e.$t("全部"))+"（"+o($.value)+"） ",1)]),_:1},8,["class"]),s(c,{class:B(["menu-item ml-5",{active:I.value=="online"}]),onClick:t[1]||(t[1]=n=>F("online"))},{default:i(()=>[s(h,{class:"mr-1"},{default:i(()=>[s(ce)]),_:1}),d(" "+o(e.$t("在线"))+"（"+o(z.value)+"） ",1)]),_:1},8,["class"]),s(c,{class:B(["menu-item ml-5",{active:I.value=="offline"}]),onClick:t[2]||(t[2]=n=>F("offline"))},{default:i(()=>[s(h,{class:"mr-1"},{default:i(()=>[s(_e)]),_:1}),d(" "+o(e.$t("离线"))+"（"+o(H.value)+"） ",1)]),_:1},8,["class"])]),l("div",null,[s(de,{modelValue:b.value,"onUpdate:modelValue":t[3]||(t[3]=n=>b.value=n),style:{width:"240px"},placeholder:e.$t("搜索矿工"),onInput:oe},{prefix:i(()=>[s(h,{class:"el-input__icon"},{default:i(()=>[s(ue)]),_:1})]),_:1},8,["modelValue","placeholder"])])])):g("",!0),r(a).ACTIVE_SUB_ACCOUNT_ID!==null?(f(),p("div",rt,[T((f(),Oe(Ce,{data:k.value,class:"w-full mt-5 shadow-[0_0_0_1px_rgba(107,114,128,.3)] rounded-md",stripe:"","row-class-name":"table-row-class","empty-text":e.$t("无矿工"),onRowClick:ie},{default:i(()=>[s(E,{prop:"status",label:" ",width:"20"},{default:i(n=>[n.row.status=="active"?(f(),p("div",ct)):g("",!0),n.row.status=="inactive"||n.row.status=="unactive"?(f(),p("div",_t)):g("",!0)]),_:1}),s(E,{prop:"workerName",label:e.$t("矿工"),sortable:""},null,8,["label"]),s(E,{prop:"realtimeHashrate",label:e.$t("10分钟算力"),sortable:""},{default:i(n=>[d(o(r(x)(r(C).ACTIVE_COIN,n.row.realtimeHashrate).num)+" "+o(r(x)(r(C).ACTIVE_COIN,n.row.realtimeHashrate).unit),1)]),_:1},8,["label"]),s(E,{prop:"avgHashrate1440",label:e.$t("24小时算力"),sortable:""},{default:i(n=>[d(o(r(x)(r(C).ACTIVE_COIN,n.row.avgHashrate1440).num)+" "+o(r(x)(r(C).ACTIVE_COIN,n.row.avgHashrate1440).unit),1)]),_:1},8,["label"]),s(E,{prop:"avgRejectrate1440",label:e.$t("拒绝率"),sortable:""},{default:i(n=>[d(o((n.row.avgRejectrate1440*100).toFixed(2))+" % ",1)]),_:1},8,["label"]),s(E,{prop:"lastShareTime",label:e.$t("最近提交日期")},{default:i(n=>[d(o(r(Ve)(n.row.lastShareTime*1e3).format("MMMM Do YYYY, h:mm:ss a")),1)]),_:1},8,["label"])]),_:1},8,["data","empty-text"])),[[fe,D.value]]),l("div",ut,[s(ve,{"current-page":y.value,"onUpdate:currentPage":t[4]||(t[4]=n=>y.value=n),"page-size":V.value,"onUpdate:pageSize":t[5]||(t[5]=n=>V.value=n),size:X.value,disabled:Z.value,background:ee.value,layout:"prev, pager, next",total:M.value,onSizeChange:ae,onCurrentChange:se},null,8,["current-page","page-size","size","disabled","background","total"])])])):g("",!0)])])}}},Tt=he(dt,[["__scopeId","data-v-24f794cd"]]);export{Tt as default};
