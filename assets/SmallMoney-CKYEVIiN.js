import{i as H,h as P,n as j,f as p,p as G,c as u,o as l,b as r,l as n,w as o,g,d as i,aR as J,aS as Q,F as S,C as O,u as x,aT as z,a$ as q,t as k,y as _,x as K,aN as W,A as X,aQ as Z,J as ee,I as d,G as E,H as T}from"./index-BWeRxd06.js";import{a as te,E as ae}from"./el-table-column-BYdxIFg2.js";/* empty css                   */const se={class:"flex items-center"},le=["src"],oe={key:0,class:"text-xs text-gray-400"},ne={class:"text-green-400"},ue={key:1,class:"text-xs text-gray-400"},re={key:2,class:"text-xs text-gray-400"},ie={key:3,class:"text-xs text-gray-400"},de={key:4,class:"text-xs text-gray-400"},me={key:0},ce=["onClick"],fe={__name:"SmallMoney",setup(_e){const B=H("payAddress-show"),I=P(),M=j(),D=p(!1),v=p(!1),m=p(""),c=p(""),b=p(!1),a=G({status:999,time:0,balance:0}),y=p([]),N=()=>{a.status=999,a.time=0,a.balance=0,y.value=[]},F=s=>{let e=Date.now();return ee(e-s).format("YYYY-MM-DD HH:mm:ss")},U=()=>{if(a.status!=0){d.error("提币失败");return}b.value=!0,E.post(T.p_submit_small_money,{sid:m.value,coin:c.value}).then(s=>{if(s.status!=200){d.error("提币失败");return}s.data.status==0?(d.success("提币成功"),V()):d.error("提币失败"),b.value=!1}).catch(s=>{b.value=!1,d.error("提币失败")})},Y=()=>{E.post(T.p_query_small_money_logs,{sid:m.value,coin:c.value}).then(s=>{if(s.status!=200){d.error("获取数据失败");return}y.value=s.data.data})},V=()=>{if(!m.value||!c.value){d.error("请先选择子账号和币种");return}v.value=!0,E.post(T.p_query_small_money,{sid:m.value,coin:c.value}).then(s=>{if(v.value=!1,s.status!=200){d.error("获取数据失败");return}a.status=s.data.data[0],a.time=s.data.data[1],a.balance=s.data.data[1]}).catch(s=>{v.value=!1,d.error("获取数据失败")}),Y()};return(s,e)=>{const C=z,h=Q,f=J,w=ae,R=te,L=W,$=Z;return l(),u(S,null,[e[11]||(e[11]=r("h1",{class:"title text-stone-50 mb-5"}," 小额提币 ",-1)),e[12]||(e[12]=r("div",{class:"mb-5"},[r("p",{class:"text-xs text-gray-400"}," 每个子账号下的每个币种，每个月可进行一次自助小额提币，旧版节点余额也可在此自助提币。 ")],-1)),n($,{"label-width":"auto"},{default:o(()=>[n(f,{label:"提币子账号"},{default:o(()=>[n(h,{placeholder:"请先选择子账号",disabled:D.value,modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=t=>m.value=t),onChange:N},{default:o(()=>[(l(!0),u(S,null,O(x(I).SUB_ACCOUNT,(t,A)=>(l(),g(C,{label:t.name,value:t.id},null,8,["label","value"]))),256))]),_:1},8,["disabled","modelValue"])]),_:1}),n(f,{label:"币种"},{default:o(()=>[n(h,{placeholder:"请先选择币种",modelValue:c.value,"onUpdate:modelValue":e[1]||(e[1]=t=>c.value=t),onChange:N},{default:o(()=>[(l(!0),u(S,null,O(x(M).SMALL_MONEY_COIN_LIST,(t,A)=>(l(),g(C,{label:t.name,value:t.coin},{default:o(()=>[r("div",se,[r("img",{src:`./icon-image/icon-${x(q).transPoolCoinName(t.coin)}.png`,class:"block h-[16px] mr-1"},null,8,le),r("span",null,k(t.name),1)])]),_:2},1032,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1}),a.status!=999?(l(),g(f,{key:0,label:"查询结果"},{default:o(()=>[a.status==0?(l(),u("div",oe,[e[3]||(e[3]=_("余额：")),r("span",ne,k(a.balance),1),e[4]||(e[4]=_("，可提币，请点击小额提币按钮开始提币。"))])):i("",!0),a.status==-1?(l(),u("div",ue,"未查询到余额, 无法提币。")):i("",!0),a.status==-2?(l(),u("div",re,[e[5]||(e[5]=_("查询到余额, 但未绑定支付地址, 请先绑定支付地址, ")),r("span",{class:"text-yellow-400 cursor-pointer underline",onClick:e[2]||(e[2]=t=>x(B)({oldCoin:!0,sid:m.value,coin:c.value}))},"点击绑定支付地址"),e[6]||(e[6]=_(", 旧版余额请绑定旧版币种方可继续提币, 绑定后请")),e[7]||(e[7]=r("span",{class:"text-yellow-400"},"重新查询",-1)),e[8]||(e[8]=_("。"))])):i("",!0),a.status==-3?(l(),u("div",ie,"距离当前子账号对应币种上次小额提币未满1个月, 无法再次提币, 上次提币日期"+k(F(a.time))+"。",1)):i("",!0),a.status==-4?(l(),u("div",de,"权限不足, 无法提币。")):i("",!0)]),_:1})):i("",!0),y.value.length?(l(),g(f,{key:1,label:"自助提币日志"},{default:o(()=>[n(R,{data:y.value,style:{width:"100%"}},{default:o(()=>[n(w,{prop:"updated_at",label:"提交日期"}),n(w,{prop:"amount",label:"提币数量"},{default:o(t=>[r("span",null,k(t.row.amount||"支付后展示"),1)]),_:1}),n(w,{prop:"status",label:"交易状态"},{default:o(t=>[t.row.status==0?(l(),u("span",me,"等待支付")):i("",!0),t.row.status==1?(l(),u("span",{key:1,class:"text-green-400 cursor-pointer underline",onClick:A=>x(q).copyText(t.row.hash)},"支付成功（点击复制交易哈希）",8,ce)):i("",!0)]),_:1})]),_:1},8,["data"])]),_:1})):i("",!0),n(f,{label:" "},{default:o(()=>[n(L,{class:"ml-0",text:"",bg:"",type:"primary",onClick:V,disabled:v.value,loading:v.value},{default:o(()=>e[9]||(e[9]=[_("查询")])),_:1},8,["disabled","loading"]),K(n(L,{class:"ml-0",text:"",bg:"",type:"success",onClick:U,disabled:b.value,loading:b.value},{default:o(()=>e[10]||(e[10]=[_("小额提币")])),_:1},8,["disabled","loading"]),[[X,a.status==0]])]),_:1})]),_:1})],64)}}};export{fe as default};
