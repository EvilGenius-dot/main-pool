import{_ as Q,J as X,k as Y,g as Z,e as c,l as ee,I as te,K as y,m as se,c as v,a as s,j as U,w as D,O as ae,L as V,t as n,b as w,u,p as ne,y as oe,F as le,z as ie,B as $,C as H,D as j,v as I,h as re,aV as ce,n as de,o as f,q as ue}from"./index-DC_M4ZfZ.js";import{E as _e}from"./el-pagination-CGK-kzKm.js";const ve={class:"over-container"},fe={class:"p-4"},Ce={class:"pt-4 px-4"},he={class:"border-t border-b py-2 text-zinc-300 border-zinc-700 bg-zinc-800 border-b-0 rounded-tl-2xl rounded-tr-2xl"},Ie={class:"flex justify-around items-center"},xe={class:"text-zinc-300 text-sm mb-1"},pe={class:"text-zinc-200 text-xs"},Te={class:"text-zinc-300 text-sm mb-1"},ge={class:"text-zinc-200 text-xs"},me={class:"text-zinc-300 text-sm mb-1"},Ae={class:"text-zinc-200 text-xs"},Ue={class:"mb-10 border-t border-b border-zinc-700 bg-zinc-800 rounded-bl-2xl rounded-br-2xl"},we={key:0,class:"relative"},Ee={class:"flex py-2 text-xs text-zinc-300 border-zinc-700"},Ne={class:"w-28 flex"},be={class:"w-20 flex"},Ve={class:"w-20 flex"},Se={class:"w-20 flex"},Oe={class:"flex py-2 text-xs text-zinc-300 border-b border-zinc-700"},ke={class:"w-28 flex"},ze={class:"w-20 flex"},Be={class:"w-20 flex"},ye={class:"miner-box"},De={key:0,class:"miner-item flex justify-center items-center text-xs py-4 text-zinc-400"},$e=["onClick"],He={class:"w-5 flex justify-center"},je={key:0,class:"online"},Re={key:1,class:"offline"},Le={class:"w-28 flex"},Me={class:"w-20 flex"},Pe={class:"w-20 flex"},Fe={class:"w-20 flex"},We={class:"demo-pagination-block"},Ke={__name:"MinerView",setup(qe){const{t:S}=X(),R=re();ce();const d=Y(),a=Z(),C=c("all"),g=c(""),E=c(!1),O=c(!1),k=c(!1),m=c(1),x=c(100),L=c("default"),M=c(!1),P=c(!1),i=ee({online:0,offline:0,currentHash:0,hash24:0}),F=te(()=>i.online||i.offline?(i.online||0)+(i.offline||0):N.value.length),N=c([]),W=e=>{let t=e.workerId||"unknow",l=e.workerName||"unknow";R.push({name:"minerinfo",params:{workerName:l,workerId:t,avgHashrate1440:e.avgHashrate1440,avgRejectrate1440:e.avgRejectrate1440,lastShareTime:e.lastShareTime,realtimeHashrate:e.realtimeHashrate,status:e.status,sid:a.ACTIVE_SUB_ACCOUNT_ID}})},A=e=>{k.value=!0,O.value=!0,$({url:H.get_account_info.replace("{coin}",d.ACTIVE_COIN).replace("{sid}",e)}).then(t=>{if(k.value=!1,O.value=!1,t.data.status==0){let l=I(d.ACTIVE_COIN,t.data.data.hashrate),h=I(d.ACTIVE_COIN,t.data.data.avg_hashrate1440);i.currentHash=`${l.num} ${l.unit}`,i.hash24=`${h.num} ${h.unit}`,i.online=t.data.data.online,i.offline=t.data.data.offline}else j.error(S("获取账户信息失败。"))})},K=e=>{console.log(`${e} items per page`)},q=e=>{T(a.ACTIVE_SUB_ACCOUNT_ID)},p=c([]),z=()=>{for(let e in i)i[e]=0;p.value=[]},T=e=>{e&&(E.value=!0,$({method:"get",url:H.get_workers.replace("{coin}",d.ACTIVE_COIN).replace("{sid}",e).replace("{page}",m.value).replace("{size}",x.value)}).then(t=>{t.data.status==0?(N.value=t.data.data,B(t.data.data)):j.error(S("获取矿工信息失败！")),E.value=!1}))},J=e=>{B(N.value)},B=e=>{p.value=[];let t=[];for(let r=0;r<e.length;r++){let _=e[r];g.value&&_.workerName.indexOf(g.value)==-1||(C.value=="all"&&t.push(_),C.value=="online"&&_.status=="active"&&t.push(_),C.value=="offline"&&_.status!="active"&&t.push(_))}let l=(m.value-1)*x.value,h=l+x.value;d.ACTIVE_COIN=="VA-LTC"&&(t=t.slice(l,h)),t.forEach(r=>{p.value.push({workerName:r.workerName,realtimeHashrate:r.realtimeHashrate,avgHashrate1440:r.avgHashrate1440,avgRejectrate1440:r.avgRejectrate1440,lastShareTime:r.lastShareTime,status:r.status,workerId:r.workerId})})},b=e=>{C.value=e,T(a.ACTIVE_SUB_ACCOUNT_ID),A(a.ACTIVE_SUB_ACCOUNT_ID)};return y(()=>a.SUB_ACCOUNT,(e,t)=>{z();const l=a.SUB_ACCOUNT;a.ACTIVE_SUB_ACCOUNT_ID==null&&l[0]&&a.SET_ACTIVE_SUB_ACCOUNT_ID(l[0].id),l[0]&&(T(a.ACTIVE_SUB_ACCOUNT_ID),A(a.ACTIVE_SUB_ACCOUNT_ID))},{deep:!0}),y(()=>d.ACTIVE_COIN,(e,t)=>{z();const l=a.SUB_ACCOUNT;a.ACTIVE_SUB_ACCOUNT_ID==null&&l[0]&&a.SET_ACTIVE_SUB_ACCOUNT_ID(l[0].id),l[0]&&(T(a.ACTIVE_SUB_ACCOUNT_ID),A(a.ACTIVE_SUB_ACCOUNT_ID))},{deep:!0}),se(()=>{const e=a.SUB_ACCOUNT;a.ACTIVE_SUB_ACCOUNT_ID==null&&e[0]&&a.SET_ACTIVE_SUB_ACCOUNT_ID(e[0].id),e[0]&&(T(a.ACTIVE_SUB_ACCOUNT_ID),A(a.ACTIVE_SUB_ACCOUNT_ID))}),(e,t)=>{const l=de("search"),h=ue,r=ae,_=_e,G=oe;return f(),v("div",ve,[s("div",fe,[U(r,{class:"miner-view-search",modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=o=>g.value=o),onInput:J,size:"large",placeholder:e.$t("输入矿工名搜索")},{suffix:D(()=>[U(h,{class:"el-input__icon"},{default:D(()=>[U(l)]),_:1})]),_:1},8,["modelValue","placeholder"])]),s("div",Ce,[s("div",he,[s("div",Ie,[s("div",{onClick:t[1]||(t[1]=o=>b("all")),class:V(["mode-item border-r border-zinc-600 flex items-center justify-center flex-col w-1/3",{active:C.value=="all"}])},[s("div",xe,n(e.$t("全部")),1),s("div",pe,n(i.online+i.offline),1)],2),s("div",{onClick:t[2]||(t[2]=o=>b("online")),class:V(["mode-item border-r border-zinc-600 flex items-center justify-center flex-col w-1/3",{active:C.value=="online"}])},[s("div",Te,n(e.$t("在线")),1),s("div",ge,n(i.online),1)],2),s("div",{onClick:t[3]||(t[3]=o=>b("offline")),class:V(["mode-item flex items-center justify-center w-1/3 flex-col",{active:C.value=="offline"}])},[s("div",me,n(e.$t("离线")),1),s("div",Ae,n(i.offline),1)],2)])]),s("div",Ue,[u(a).ACTIVE_SUB_ACCOUNT_ID!==null?(f(),v("div",we,[s("div",Ee,[t[6]||(t[6]=s("div",{class:"w-5 flex justify-center"},null,-1)),s("div",Ne,n(e.$t("矿工名")),1),s("div",be,n(e.$t("10分钟算力")),1),s("div",Ve,n(e.$t("24小时算力")),1),s("div",Se,n(e.$t("拒绝率")),1)]),s("div",Oe,[t[7]||(t[7]=s("div",{class:"w-5 flex justify-center"},null,-1)),s("div",ke,n(e.$t("总计")),1),s("div",ze,n(i.currentHash),1),s("div",Be,n(i.hash24),1),t[8]||(t[8]=s("div",{class:"w-20 flex"}," - ",-1))]),s("div",ye,[ne((f(),v("div",null,[p.value.length?w("",!0):(f(),v("div",De,n(e.$t("无活跃矿工")),1)),(f(!0),v(le,null,ie(p.value,o=>(f(),v("div",{class:"miner-item flex justify-between items-center text-xs py-4 text-zinc-400",onClick:Je=>W(o)},[s("div",He,[o.status=="active"?(f(),v("div",je)):w("",!0),o.status=="inactive"?(f(),v("div",Re)):w("",!0)]),s("div",Le,n(o.workerName),1),s("div",Me,n(u(I)(u(d).ACTIVE_COIN,o.realtimeHashrate).num)+" "+n(u(I)(u(d).ACTIVE_COIN,o.realtimeHashrate).unit),1),s("div",Pe,n(u(I)(u(d).ACTIVE_COIN,o.avgHashrate1440).num)+" "+n(u(I)(u(d).ACTIVE_COIN,o.avgHashrate1440).unit),1),s("div",Fe,n((o.avgRejectrate1440*100).toFixed(2))+" % ",1)],8,$e))),256))])),[[G,E.value]])]),s("div",We,[U(_,{"current-page":m.value,"onUpdate:currentPage":t[4]||(t[4]=o=>m.value=o),"page-size":x.value,"onUpdate:pageSize":t[5]||(t[5]=o=>x.value=o),size:L.value,disabled:M.value,background:P.value,layout:"prev, pager, next",total:F.value,onSizeChange:K,onCurrentChange:q},null,8,["current-page","page-size","size","disabled","background","total"])])])):w("",!0)])])])}}},Xe=Q(Ke,[["__scopeId","data-v-c4454ef7"]]);export{Xe as default};
